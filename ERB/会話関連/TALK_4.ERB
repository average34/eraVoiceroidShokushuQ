;拘束具キャラとの会話イベント
;ARG:0	対象キャラ
@TALK_4(ARG:0)
;LOCAL
;0	LOOP
;1	誘えるかどうか
;2	TEMP

PRINTFORML 迷宮の中を進んでいくと、

TRYCALL PRINT_SHOW_CLOTH(ARG:0)

PRINTFORM %CALLNAME:(ARG:0)%  (戦闘素質 {ABL:(ARG:0):98, 2} / 速度 {ABL:(ARG:0):97, 2})  と出会った。
PRINTFORML 

WAIT

$TALK_START

;遭遇相手の様子
CALL TALK_LOOK(ARG)

PRINTFORML どうしますか？
PRINTFORML [1] 持っている物を奪う
SIF ITEM:58 && CFLAG:(ARG:0):29 == 1
	PRINTFORML [2] 気付け薬（残り：{ITEM:58}個）を使ってあげる
SIF ITEM:58 && ITEM:52 && CFLAG:(ARG:0):29 == 1
	PRINTFORML [3] 気付け薬（残り：{ITEM:58}個）を使って、さらに日本酒（残り：{ITEM:52}個）を渡す。

IF (GET_PENIS(1) > 0) && (FLAG:520 == 2 || (FLAG:10 == 0 || (FLAG:11 == 0 && (CFLAG:(FLAG:10):29 || GET_PENIS(FLAG:10) > 0)) || ((CFLAG:(FLAG:10):29 || GET_PENIS(FLAG:10) > 0) && (CFLAG:(FLAG:11):29 || GET_PENIS(FLAG:11) > 0))))
	;主人公がふたなりで、仲間がいないか全員戦意喪失かふたなりだと犯せる
	LOCAL:3 = 1
	PRINTFORML [5] 性欲を発散する

ELSE
	LOCAL:3 = 0
ENDIF
SIF TALENT:(ARG:0):130 >= 1
	PRINTFORML [6] 乳搾り
SIF GET_PENIS(ARG:0) & 1 && ITEM:55
	PRINTFORML [7] %ITEMNAME:55%(残り{ITEM:55}個)を使ってあげる
IF GET_PENIS(ARG:0) > 0
	PRINTFORML [8] 勃起を治療する
ENDIF
SIF CFLAG:(ARG:0):22 && CFLAG:(ARG:0):36 == 0 && ITEM:57
	PRINTFORML [10] %ITEMNAME:57%(残り{ITEM:57}個)を使ってあげる
SIF BASE:(ARG:0):3 <= MAXBASE:(ARG:0):3 / 2 && ITEM:54
	PRINTFORML [11] %ITEMNAME:54%(残り{ITEM:54}個)を着せてあげる
SIF ITEM:69
	PRINTFORML [12] %ITEMNAME:69%(残り{ITEM:69}個)を飲ませる
SIF CFLAG:(ARG:0):504 == 1
	PRINTFORML [13] %ITEMNAME:8%を解除する
;催眠術による追加コマンド
;ヒュプノ魔眼による催眠術
IF ( CFLAG:1:7 == 40 || CFLAG:1:8 == 40 || CFLAG:1:9 == 40 || CFLAG:(FLAG:10):7 == 40 || CFLAG:(FLAG:10):8 == 40 || CFLAG:(FLAG:10):9 == 40 || CFLAG:(FLAG:11):7 == 40 || CFLAG:(FLAG:11):8 == 40 || CFLAG:(FLAG:11):9 == 40 )
	IF !CFLAG:(ARG:0):43
		PRINTFORML [14] 催眠をかける
	ELSEIF CFLAG:(ARG:0):43
		PRINTFORML [14] 催眠を解く
	ENDIF
ENDIF
SIF CFLAG:(ARG:0):43
	PRINTFORML [15] 視姦する
SIF CFLAG:(ARG:0):47 == 1
	PRINTFORML [16] 貞操帯を外す
IF FLAG:(50 + FLAG:5) > 10
	SIF CFLAG:(ARG:0):47 == 0
		PRINTFORML [21] Vに触手を入れて放置
		
	PRINTFORML [22] Bを触手で吸わせて放置
	PRINTFORML [23] Aに触手を入れて放置
	PRINTFORML [24] Cを触手で吸わせて放置
	PRINTFORML [25] 口に触手を入れて放置
ENDIF
SIF PET:0
	PRINTFORML [26] ペットに「食べさせる」
PRINTFORML [110] 能力を見る

PRINTFORML [0] 何もせず別れを告げる


$INPUT_LOOP
INPUT

IF RESULT == 0
	CALL PRINT_MESSAGE(1, 102, ARG:0, CALLNAME:1, CALLNAME:(ARG:0), 1)
	RETURN
ELSEIF RESULT == 1
	CALL PRINT_MESSAGE(1, 138, ARG:0, CALLNAME:1, CALLNAME:(ARG:0), 1)
	IF CFLAG:(ARG:0):5 > 0
		;普通の物が貰える
		CFLAG:(ARG:0):5 -= 30 + RAND:30
		SELECTCASE RAND:100
			CASE 0 TO 4
				LOCAL:2 = 1
			CASE 5 TO 9
				LOCAL:2 = 2
			CASE 10 TO 14
				LOCAL:2 = 10
			CASE 15 TO 19
				LOCAL:2 = 11
			CASE 20 TO 29
				LOCAL:2 = 20
			CASE 30 TO 39
				LOCAL:2 = 24
			CASE 40 TO 59
				LOCAL:2 = 50
			CASE 60 TO 79
				LOCAL:2 = 52
			CASE 80 TO 89
				LOCAL:2 = 54
			CASE 90 TO 94
				LOCAL:2 = 55
			CASE 95 TO 99
				LOCAL:2 = 56
			CASEELSE
				LOCAL:2 = 50
		ENDSELECT
		CALL ADD_ITEM(LOCAL:2, 1, 0)
		CALL PRINT_MESSAGE(ARG:0, 139, LOCAL:2, CALLNAME:1, CALLNAME:(ARG:0))
		CALL PRINT_MESSAGE(1, 105, ARG:0, CALLNAME:1, CALLNAME:(ARG:0), LOCAL:2, 1)
	ELSE
		CALL PRINT_MESSAGE(ARG:0, 139, 0, CALLNAME:1, CALLNAME:(ARG:0))
		CALL PRINT_MESSAGE(1, 106, ARG:0, CALLNAME:1, CALLNAME:(ARG:0), 1)
	ENDIF
	
ELSEIF RESULT == 2 && ITEM:58
	CALL ADD_ITEM(58, -1, 0)
	CALL PRINT_MESSAGE(1, 143, ARG:0, CALLNAME:1, CALLNAME:(ARG:0), 0)
	CFLAG:(ARG:0):5 += 200
	BASE:(ARG:0):1 = MAXBASE:(ARG:0):1 / 4
	;主人公が【治療】持ちだと効果増加　ただし発情・戦意喪失・寄生or妊娠末期は無理
	SIF TALENT:1:117 && CFLAG:1:28 == 0 && CFLAG:1:29 == 0 && (CFLAG:1:22 == 0 || CFLAG:1:23 >= 5)
		BASE:(ARG:0):1 += MAXBASE:(ARG:0):1 / 4

	CFLAG:(ARG:0):29 = 0
	;ED追加
	CALL ADD_HISTORY(DAY, ARG:0,, 5)

	CALL PRINT_MESSAGE(ARG:0, 144, 0, CALLNAME:1, CALLNAME:(ARG:0))

ELSEIF RESULT == 3 && ITEM:58 && ITEM:52
	CALL ADD_ITEM(58, -1, 0)
	CALL ADD_ITEM(52, -1, 0)
	CALL PRINT_MESSAGE(1, 143, ARG:0, CALLNAME:1, CALLNAME:(ARG:0), 0)
	CFLAG:(ARG:0):5 += 200
	BASE:(ARG:0):1 = MAXBASE:(ARG:0):1 / 2
	;主人公が【治療】持ちでも【鼓舞】持ちでも効果増加　ただし発情・戦意喪失・寄生or妊娠末期は無理
	IF TALENT:1:117 && CFLAG:1:28 == 0 && CFLAG:1:29 == 0 && (CFLAG:1:22 == 0 || CFLAG:1:23 >= 5)
		BASE:(ARG:0):1 += MAXBASE:(ARG:0):1 / 4
	ELSEIF TALENT:1:118 && CFLAG:1:28 == 0 && CFLAG:1:29 == 0 && (CFLAG:1:22 == 0 || CFLAG:1:23 >= 5)
		BASE:(ARG:0):1 += MAXBASE:(ARG:0):1 / 8
	ENDIF
	CFLAG:(ARG:0):29 = 0
	CALL PRINT_MESSAGE(ARG:0, 144, 4, CALLNAME:1, CALLNAME:(ARG:0))
	IF RAND:4 >= 3
		CALL PRINT_MESSAGE(ARG:0, 144, 5, CALLNAME:1, CALLNAME:(ARG:0))
	ELSE
		CALL PRINT_MESSAGE(ARG:0, 144, 0, CALLNAME:1, CALLNAME:(ARG:0))
	ENDIF
	;ED追加
	CALL ADD_HISTORY(DAY, ARG:0,, 5)

ELSEIF RESULT == 5 && LOCAL:3
CALL NPC_RAPE(ARG:0)
WAIT
CALL ADD_ABL_EXP_PT(13, 3 + RAND:5)
;好感度はもうズタボロ
CFLAG:(ARG:0):5 -= 90 + RAND:30


;母乳飲み
ELSEIF RESULT == 6 && TALENT:(ARG:0):130 >= 1
	CALL PRINT_MESSAGE(ARG:0, 144, 6, CALLNAME:1, CALLNAME:(ARG:0))
	TFLAG:63 = 1
	IF CFLAG:1:29 == 0
		CALL DRINK_MILK_RECOVERY(ARG:0, 1)
	ELSEIF CFLAG:1:29 == 1 && RAND:20 == 0
		CFLAG:1:29 = 0
		CALL PRINT_MESSAGE(1, 36, 58,CALLNAME:1, "")
	ENDIF

	;仲間も回復
	IF FLAG:10 > 0 && CFLAG:(FLAG:10):29 == 0
		CALL DRINK_MILK_RECOVERY(ARG:0, FLAG:10)
	ELSEIF FLAG:10 > 0 && CFLAG:(FLAG:10):29 == 1 && RAND:20 == 0
		CFLAG:(FLAG:10):29 = 0
		CALL PRINT_MESSAGE((FLAG:10), 36, 58, CALLNAME:(FLAG:10), "")
	ENDIF

	IF FLAG:11 > 0 && CFLAG:(FLAG:11):29 == 0
		CALL DRINK_MILK_RECOVERY(ARG:0, FLAG:11)
	ELSEIF FLAG:11 > 0 && CFLAG:(FLAG:11):29 == 1 && RAND:20 == 0
		CFLAG:(FLAG:11):29 = 0
		CALL PRINT_MESSAGE((FLAG:11), 36, 58,CALLNAME: (FLAG:11), "")
	ENDIF
	FOR LOCAL:0,0,(RAND:7 +4)
		CALL DAMAGE_COMMON(ARG:0, 2, 8000 + RAND:4001, 100)
	NEXT
	CALL PRINT_MESSAGE(ARG:0, 144, 12, CALLNAME:1, CALLNAME:(ARG:0))
	CALL ADD_ABL_EXP_PT(13, 3 + RAND:5)
	;好感度はもちろん下がる 肥大化しかけや噴乳中毒なら別
	CFLAG:(ARG:0):5 -= 50 + RAND:20 - CFLAG:(ARG:0):506 - (ABL:(ARG:0):16 * 25) 
	
	SIF CFLAG:(ARG:0):506 > 10
		CFLAG:(ARG:0):506 -= RAND:25

ELSEIF RESULT == 7 && ITEM:55
	CALL ADD_ITEM(55, -1, 0)
		SIF CFLAG:(ARG:0):42 > 0
			CFLAG:(ARG:0):42 = 0
		CFLAG:(ARG:0):5 += 30

ELSEIF RESULT == 8
	CALL NPC_RAPE_2(ARG:0)
	WAIT
ELSEIF RESULT == 10 && ITEM:57
	CALL ADD_ITEM(57, -1, 0)
	CFLAG:(ARG:0):22 = 0
	CFLAG:(ARG:0):5 += 70
ELSEIF RESULT == 11 && ITEM:54
	CALL ADD_ITEM(54, -1, 0)
	BASE:(ARG:0):3 = MAXBASE:(ARG:0):3
	CFLAG:(ARG:0):44 = 0
	CALL CLOTH_TYPE_2(ARG:0)
	CFLAG:(ARG:0):5 += 70		
ELSEIF RESULT == 12 && ITEM:69
	CALL ADD_ITEM(69, -1, 0)
	CALL ADD_BUST(ARG:0,-1,1,69)
	CFLAG:(ARG:0):5 -= 10

ELSEIF RESULT == 13 
	CFLAG:(ARG:0):504 = 0
ELSEIF RESULT == 14 && ( CFLAG:1:7 == 40 || CFLAG:1:8 == 40 || CFLAG:1:9 == 40 || CFLAG:(FLAG:10):7 == 40 || CFLAG:(FLAG:10):8 == 40 || CFLAG:(FLAG:10):9 == 40 || CFLAG:(FLAG:11):7 == 40 || CFLAG:(FLAG:11):8 == 40 || CFLAG:(FLAG:11):9 == 40 )
	IF !CFLAG:(ARG:0):43
		CALL SET_HYPNO_TYPE(ARG:0)
		CFLAG:(ARG:0):43 = 1
	ELSEIF CFLAG:(ARG:0):43
		CFLAG:(ARG:0):43 = 0
	ENDIF
	CALL PRINT_MESSAGE(ARG:0, 507, 0, CALLNAME:1, CALLNAME:(ARG:0))
	GOTO TALK_START
ELSEIF RESULT == 15
		TFLAG:63 = 0
		CALL DAMAGE_COMMON(ARG:0, 2, 8000 + RAND:4001, 100)
		TFLAG:63 = 1
		CALL DAMAGE_COMMON(ARG:0, 2, 8000 + RAND:4001, 100)
		TFLAG:63 = 2
		CALL DAMAGE_COMMON(ARG:0, 2, 8000 + RAND:4001, 100)
		TFLAG:63 = 3
		CALL DAMAGE_COMMON(ARG:0, 2, 8000 + RAND:4001, 100)
		CALL PRINT_MESSAGE(ARG:0, 507, 1, CALLNAME:1, CALLNAME:(ARG:0))
ELSEIF RESULT == 16 && CFLAG:(ARG:0):47 == 1
	CFLAG:(ARG:0):47 = 0
	PRINTFORMW 貞操帯を外した
	GOTO TALK_START
ELSEIF RESULT == 21 && FLAG:(50 + FLAG:5) > 10 && CFLAG:(ARG:0):47 == 0
	CFLAG:(ARG:0):505 |= 1
	GOTO TALK_START
ELSEIF RESULT == 22 && FLAG:(50 + FLAG:5) > 10
	CFLAG:(ARG:0):505 |= 2
	GOTO TALK_START
ELSEIF RESULT == 23 && FLAG:(50 + FLAG:5) > 10
	CFLAG:(ARG:0):505 |= 4
	GOTO TALK_START
ELSEIF RESULT == 24 && FLAG:(50 + FLAG:5) > 10
	CFLAG:(ARG:0):505 |= 8
	GOTO TALK_START
ELSEIF RESULT == 25 && FLAG:(50 + FLAG:5) > 10
	CFLAG:(ARG:0):505 |= 16
	GOTO TALK_START
ELSEIF RESULT == 26 && PET:0
	PRINTFORML %CALLNAME:1%は%CALLNAME:(ARG:0)%が拘束されているのをいいことに、その身体を%PETNAME%の好きにさせることにした……
	FOR LOCAL, 0, RAND:7 + 1
		CALL PET_RAPE(ARG:0)
		CFLAG:(ARG:0):5 -= RAND:10 + 5
	NEXT
ELSEIF RESULT == 110
	CALL SHOW_PERSONAL_STATUS(ARG:0)
	GOTO TALK_START
ELSE
	REUSELASTLINE 入力値が不正です。再入力してください
	GOTO INPUT_LOOP
ENDIF
