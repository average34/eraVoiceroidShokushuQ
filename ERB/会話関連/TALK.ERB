
;≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡
;通常の会話イベント
;ARG:0	対象キャラ
;≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡
@TALK(ARG:0)
#DIM WHAT_DO
;LOCAL
;0	LOOP
;1	誘えるかどうか
;2	TEMP
;3	使ったアイテム

;5-6	HP低下
;7-8	MP低下
;9		CP低下
;10		寄生

PRINTFORML 迷宮の中を進んでいくと、
SIF CFLAG:(ARG:0):43
	PRINTFORM 催眠状態の

TRYCALL PRINT_SHOW_CLOTH(ARG:0)

PRINTFORM %CALLNAME:(ARG:0)%  (戦闘素質 {ABL:(ARG:0):98, 2} / 速度 {ABL:(ARG:0):97, 2})  と出会った
PRINTFORML 

CALL PRINT_MESSAGE(1, 101, ARG:0, CALLNAME:1, CALLNAME:(ARG:0))

TWAIT 1000, 0

CALL NPC_RAPE_3(ARG:0)
CALL NPC_RAPE_4(ARG:0)

$TALK_START
IF TALK_LOWHP(ARG)
	LOCAL:5 = 50
	LOCAL:6 = 51
ELSE
	LOCAL:5 = 0
	LOCAL:6 = 0
ENDIF
IF TALK_LOWMP(ARG)
	LOCAL:7 = 52
	LOCAL:8 = 53
ELSE
	LOCAL:7 = 0
	LOCAL:8 = 0
ENDIF
IF BASE:(ARG:0):3 <= 0
	LOCAL:9 = 54
ELSE
	LOCAL:9 = 0
ENDIF
IF (CFLAG:(ARG:0):22 && CFLAG:(ARG:0):36 == 0) || CFLAG:(ARG:0):152 || CFLAG:(ARG:0):162
	LOCAL:10 = 57
ELSE
	LOCAL:10 = 0
ENDIF

;遭遇相手の様子
CALL TALK_LOOK(ARG)

PRINTFORML どうしますか？
PRINTFORML [ 1] 雑談して気を紛らわせる
PRINTFORML [ 2] 情報交換を行う
PRINTFORML [ 3] 何か貰えないか聞いてみる
IF FLAG:11 == 0
	;3人目まで埋まってないなら誘える
	LOCAL:1 = 1
	PRINTFORML [ 4] 仲間に誘う
ELSE
	LOCAL:1 = 0
ENDIF
IF LOCAL:5 && ITEM:50
	PRINTFORML [ 5] %ITEMNAME:50%(残り{ITEM:50}個)をあげる
ELSE
	LOCAL:5 = 0
ENDIF
IF LOCAL:6 && ITEM:51
	PRINTFORML [ 6] %ITEMNAME:51%(残り{ITEM:51}個)をあげる
ELSE
	LOCAL:6 = 0
ENDIF
IF LOCAL:7 && ITEM:52
	PRINTFORML [ 7] %ITEMNAME:52%(残り{ITEM:52}個)をあげる
ELSE
	LOCAL:7 = 0
ENDIF
IF LOCAL:8 && ITEM:53
	PRINTFORML [ 8] %ITEMNAME:53%(残り{ITEM:53}個)をあげる
ELSE
	LOCAL:8 = 0
ENDIF
IF LOCAL:9 && ITEM:54
	PRINTFORML [ 9] %ITEMNAME:54%(残り{ITEM:54}個)をあげる
ELSE
	LOCAL:9 = 0
ENDIF
IF LOCAL:10 && ITEM:57
	PRINTFORML [10] %ITEMNAME:57%(残り{ITEM:57}個)をあげる
ELSE
	LOCAL:10 = 0
ENDIF
IF GET_PENIS(ARG:0) == 1 && ITEM:55
	PRINTFORML [11] %ITEMNAME:55%(残り{ITEM:55}個)をあげる
ENDIF

PRINTFORML [12] 装備品をプレゼントする

SIF TALENT:(ARG:0):130 >= 1
	PRINTFORML [13] 乳搾り

;催眠術による追加コマンド
;ヒュプノ魔眼による催眠術
IF ( CFLAG:1:7 == 40 || CFLAG:1:8 == 40 || CFLAG:1:9 == 40 || CFLAG:(FLAG:10):7 == 40 || CFLAG:(FLAG:10):8 == 40 || CFLAG:(FLAG:10):9 == 40 || CFLAG:(FLAG:11):7 == 40 || CFLAG:(FLAG:11):8 == 40 || CFLAG:(FLAG:11):9 == 40 )
	IF !CFLAG:(ARG:0):43
		PRINTFORML [15] 催眠をかける
	ELSEIF CFLAG:(ARG:0):43
		PRINTFORML [15] 催眠を解く
	ENDIF
ENDIF
;性欲発散や拘束具は睡眠か催眠で意識を失った相手のみ
IF CFLAG:(ARG:0):43
	IF (GET_PENIS(1) > 0) && (FLAG:520 == 2 || (FLAG:10 == 0 || (FLAG:11 == 0 && (CFLAG:(FLAG:10):29 || GET_PENIS(FLAG:10) > 0)) || ((CFLAG:(FLAG:10):29 || GET_PENIS(FLAG:10) > 0) && (CFLAG:(FLAG:11):29 || GET_PENIS(FLAG:11) > 0))))
		;主人公がふたなりで、仲間がいないか全員戦意喪失かふたなりだと犯せる
		PRINTFORML [16] 性欲を発散する
	ENDIF
	IF ITEM:8 && ITEM:88 >= 10
		PRINTFORML [17] %ITEMNAME:8%を使う
	ENDIF
	PRINTFORML [18] 視姦する
	IF CFLAG:1:29 == 0
		PRINTFORML [19] 罵倒してもらう
		PRINTFORML [20] 踏んでもらう
	ENDIF
ENDIF

IF (LOCAL:7 && ITEM:52 > 0) ||(LOCAL:8 && ITEM:53 > 0) && ITEM:65 > 0
	PRINTFORML [21] ドリンクに睡眠薬を仕込む
ENDIF

SIF GET_PENIS(ARG:0) > 0
	PRINTFORML [22] 勃起を治療する

SIF PET:0 && CFLAG:(ARG:0):43
	PRINTFORML [23] ペットに「食べさせる」

;ペットがいる+主人公結婚済+報告がまだ
SIF PET:0 && TALENT:1:140 == 2 && CFLAG:(ARG:0):180 == 0
	PRINTFORML [24] 結婚の報告をする
;ペットがいる+素質ペットor花嫁
SIF PET:0 && TALENT:1:140
	PRINTFORML [25] 一緒に身体を捧げるのに誘う


IF CFLAG:1:29 == 0 && ABL:1:13 > 0
	PRINTFORML [30] キスをする
ENDIF

PRINTFORML [110] 能力を見る

PRINTFORML [ 0] 何もせず別れを告げる

;＝＝＝＝＝＝＝ここから入力処理＝＝＝＝＝＝＝
$INPUT_LOOP

IF FLAG:AUTOMODE
	WHAT_DO = 0
	SELECTCASE RAND:3
		CASE 0
			WHAT_DO = 1
		CASE 1
			WHAT_DO = 2
		CASE 2
			IF FLAG:11
				WHAT_DO = 3
			ELSE
				WHAT_DO = 4
			ENDIF
			
		CASEELSE
			WHAT_DO = 0
	ENDSELECT
	TINPUT FLAG:AUTOMODE * 1000, WHAT_DO, 0, ""
ELSE
	INPUT
ENDIF

;何もせず別れを告げる
IF RESULT == 0
	;ドッペル警戒、および恨まれてる相手の回避はこれ
	CALL PRINT_MESSAGE(1, 102, ARG:0, CALLNAME:1, CALLNAME:(ARG:0))
	RETURN
	
;雑談して気を紛らわせる
ELSEIF RESULT == 1
	CALL CHECK_COUNTER(ARG:0)
	;逆襲された場合、もう何もしない
	SIF RESULT
		RETURN
	
	CALL TALK_EV_1(ARG)
	
;情報交換を行う
ELSEIF RESULT == 2
	CALL CHECK_COUNTER(ARG:0)
	;逆襲された場合、もう何もしない
	SIF RESULT
		RETURN
	
	CALL TALK_EV_2(ARG)
	
;何か貰えないか聞いてみる
ELSEIF RESULT == 3
	CALL CHECK_COUNTER(ARG:0)
	;逆襲された場合、もう何もしない
	SIF RESULT
		RETURN
	
	CALL TALK_EV_3(ARG)
	
;仲間に誘う
ELSEIF RESULT == 4 && LOCAL:1
	CALL CHECK_COUNTER(ARG:0)
	;逆襲された場合、もう何もしない
	SIF RESULT
		RETURN
	
	CALL TALK_EV_4(ARG)
	
;アイテム譲渡
ELSEIF RESULT >= 5 && RESULT <= 10 && LOCAL:(RESULT)
	LOCAL:3 = LOCAL:(RESULT)
	CALL ADD_ITEM(LOCAL:3, -1, 0)
	CALL PRINT_MESSAGE(1, 163, ARG:0, CALLNAME:1, CALLNAME:(ARG:0), LOCAL:3)
	CALL PRINT_MESSAGE(ARG:0, 164, ARG:0, CALLNAME:1, CALLNAME:(ARG:0), LOCAL:3)
	SELECTCASE LOCAL:3
		CASE 50
			BASE:(ARG:0):0 += MAXBASE:(ARG:0):0 / 2
			CFLAG:(ARG:0):5 += 30
		CASE 51
			BASE:(ARG:0):0 = MAXBASE:(ARG:0):0
			CFLAG:(ARG:0):5 += 60
		CASE 52
			BASE:(ARG:0):1 += MAXBASE:(ARG:0):1 / 4
			;主人公が【鼓舞】持ちだと効果増加　ただし発情・戦意喪失・寄生or妊娠末期は無理
			SIF TALENT:1:118 && CFLAG:1:28 == 0 && CFLAG:1:29 == 0 && (CFLAG:1:22 == 0 || CFLAG:1:23 >= 5)
				BASE:(ARG:0):1 += MAXBASE:(ARG:0):1 / 8

			CFLAG:(ARG:0):5 += 40
				IF RAND:10 >= 6
					CALL PRINT_MESSAGE(ARG:0, 144, 5, CALLNAME:1, CALLNAME:(ARG:0))
				ENDIF
		CASE 53
			BASE:(ARG:0):1 += MAXBASE:(ARG:0):1 / 2
			;主人公が【鼓舞】持ちだと効果増加　ただし発情・戦意喪失・寄生or妊娠末期は無理
			SIF TALENT:1:118 && CFLAG:1:28 == 0 && CFLAG:1:29 == 0 && (CFLAG:1:22 == 0 || CFLAG:1:23 >= 5)
				BASE:(ARG:0):1 += MAXBASE:(ARG:0):1 / 4

			CFLAG:(ARG:0):5 += 80
			;オーバーしたら好感度にボーナス
			IF BASE:(ARG:0):1 > MAXBASE:(ARG:0):1
				BASE:(ARG:0):1 = MAXBASE:(ARG:0):1
				CFLAG:(ARG:0):5 += 40
			ENDIF

				IF RAND:10 >= 6
					CALL PRINT_MESSAGE(ARG:0, 144, 5, CALLNAME:1, CALLNAME:(ARG:0))
				ENDIF
		CASE 54
			;CPが残っていれば汚れも回復
			BASE:(ARG:0):5 *= (MAXBASE:(ARG:0):3 - BASE:(ARG:0):3) / MAXBASE:(ARG:0):3
			BASE:(ARG:0):3 = MAXBASE:(ARG:0):3
			CFLAG:(ARG:0):44 = 0
			CALL CLOTH_TYPE_2(ARG:0)
			;◆触手スーツを君に
			IF (FLAG:(FLAG:5 + 50) + RAND:250) >= 200 || CFLAG:(LOCAL:51):501 == 15 || CFLAG:(LOCAL:51):501 == 22
				CALL PRINT_MESSAGE(1, 163, ARG:0, CALLNAME:1, CALLNAME:(ARG:0), 54)
				CALL PRINT_MESSAGE((ARG:0), 440, 0, CALLNAME:(ARG:0), "")
				CALL PRINT_MESSAGE((ARG:0), 440, 20, CALLNAME:(ARG:0), "")
				CALL PRINT_MESSAGE(ARG:0, 440, 5, CALLNAME:(ARG:0), "")
				CALL PRINT_MESSAGE(ARG:0, 440, 15, CALLNAME:(ARG:0), "")
				CFLAG:(ARG:0):40 = 1
				BASE:(ARG:0):3 = MAXBASE:(ARG:0):3
				;我々の業界ではご褒美ですor人類には早すぎる
				IF ABL:(ARG:0):13 >= 3
					CFLAG:(ARG:0):5 += RAND:30
				ELSE
					CFLAG:(ARG:0):5 -= RAND:30
				ENDIF
			ELSE
				CFLAG:(ARG:0):5 += 40
			ENDIF
			;◆好感度以外触手スーツ
		CASE 57
			SIF CFLAG:(ARG:0):22
				CFLAG:(ARG:0):23 = 0
			CFLAG:(ARG:0):22 = 0
			
			CFLAG:(ARG:0):151 = 0
			CFLAG:(ARG:0):152 = 0
			CFLAG:(ARG:0):161 = 0
			CFLAG:(ARG:0):162 = 0
			CFLAG:(ARG:0):5 += 70
				SIF RAND:10 >= 6
					CALL PRINT_MESSAGE(ARG:0, 144, 5, CALLNAME:1, CALLNAME:(ARG:0))
		CASEELSE
			;よく分からないけどとりあえずプラス
			CFLAG:(ARG:0):5 += 30
	ENDSELECT
	GOTO TALK_START

;ふたなりを治す
ELSEIF RESULT == 11
	CALL ADD_ITEM(55, -1, 0)
		SIF CFLAG:(ARG:0):42 > 0
			CFLAG:(ARG:0):42 = 0
	CFLAG:(ARG:0):5 += 30
	GOTO TALK_START

;母乳飲み
ELSEIF RESULT == 13 && TALENT:(ARG:0):130 >= 1
	;成功条件 好感度、レズ中毒、噴乳中毒、母乳のたまり具合
	IF CFLAG:(ARG:0):5 + (ABL:(ARG:0):13 * 15) + (ABL:(ARG:0):16 * 15) + CFLAG:(ARG:0):506 > 200 || CFLAG:(ARG:0):43
		TFLAG:63 = 1
		CALL PRINT_MESSAGE(ARG:0, 144, 7, CALLNAME:1, CALLNAME:(ARG:0))
		CALL DRINK_MILK_RECOVERY(ARG:0, 1)
		;仲間も回復
		IF FLAG:10 > 0 && CFLAG:(FLAG:10):42 && CFLAG:(FLAG:10):29 == 0
			CALL DRINK_MILK_RECOVERY(ARG:0, FLAG:10)
		ENDIF

		IF FLAG:11 > 0 && CFLAG:(FLAG:11):42 && CFLAG:(FLAG:11):29 == 0
			CALL DRINK_MILK_RECOVERY(ARG:0, FLAG:11)
		ENDIF
		FOR LOCAL:0,0,(RAND:3 +2)
			CALL DAMAGE_COMMON(ARG:0, 2, 1000, 100)
		NEXT
		CALL PRINT_MESSAGE(ARG:0, 144, 12, CALLNAME:1, CALLNAME:(ARG:0))
	;成功なら好感度は上がる。百合ですね　催眠でもこっち
	CFLAG:(ARG:0):5 += RAND:30

	;膨乳は収まる
	SIF CFLAG:(ARG:0):506 > 10
		CFLAG:(ARG:0):506 -= RAND:10

	CALL ADD_ABL_EXP_PT(2, 700)
	CALL ADD_ABL_EXP_PT(13, 3 + RAND:5)

	ELSE
		CFLAG:(ARG:0):5 -= 35 + RAND:15
		CALL ADD_ABL_EXP_PT(2, 1200)
		CALL PRINT_MESSAGE(ARG:0, 144, 8, CALLNAME:1, CALLNAME:(ARG:0))
	ENDIF
	
;装備品をプレゼントする
ELSEIF RESULT == 12
	CALL PRESENT(ARG:0, 0)
	GOTO TALK_START
	
;催眠をかける・解く
ELSEIF RESULT == 15 && ( CFLAG:1:7 == 40 || CFLAG:1:8 == 40 || CFLAG:1:9 == 40 || CFLAG:(FLAG:10):7 == 40 || CFLAG:(FLAG:10):8 == 40 || CFLAG:(FLAG:10):9 == 40 || CFLAG:(FLAG:11):7 == 40 || CFLAG:(FLAG:11):8 == 40 || CFLAG:(FLAG:11):9 == 40 )
	IF !CFLAG:(ARG:0):43
		CALL SET_HYPNO_TYPE(ARG:0)
		CFLAG:(ARG:0):43 = 1
	ELSEIF CFLAG:(ARG:0):43
		CFLAG:(ARG:0):43 = 0
	ENDIF
	CALL PRINT_MESSAGE(ARG:0, 507, 0, CALLNAME:1, CALLNAME:(ARG:0))
	GOTO TALK_START
	
;性欲を発散する
ELSEIF RESULT == 16 && CFLAG:(ARG:0):43
	CALL NPC_RAPE(ARG:0)
	IF FLAG:AUTOMODE
		TWAIT FLAG:AUTOMODE * 500, 0
	ELSE
		WAIT
	ENDIF
	CALL ADD_ABL_EXP_PT(13, 3 + RAND:5)
	
;魔法の拘束具
ELSEIF RESULT == 17 && CFLAG:(ARG:0):43 && ITEM:8 && ITEM:88 >= 10
	CALL ADD_ITEM(8, -1, 0)
	CALL ADD_ITEM(88, -10, 0)
	CFLAG:(ARG:0):504 = 1
	CALL PRINT_MESSAGE(ARG:0, 144, 13, CALLNAME:1, CALLNAME:(ARG:0))
	
;視姦
ELSEIF RESULT == 18 && CFLAG:(ARG:0):43
	IF RAND:2 == 0 && CFLAG:(ARG:0):44 != 1 && BASE:(ARG:0):3 > 100
		TFLAG:63 = 0
		CALL DAMAGE_COMMON(ARG:0, 2, 8000 + RAND:4001, 100)
		TFLAG:63 = 1
		CALL DAMAGE_COMMON(ARG:0, 2, 8000 + RAND:4001, 100)
		TFLAG:63 = 2
		CALL DAMAGE_COMMON(ARG:0, 2, 8000 + RAND:4001, 100)
		TFLAG:63 = 3
		CALL DAMAGE_COMMON(ARG:0, 2, 8000 + RAND:4001, 100)
		CFLAG:(ARG:0):44 = 1
		BASE:(ARG:0):3 -= 100
		CALL PRINT_MESSAGE(ARG:0, 507, 2, CALLNAME:1, CALLNAME:(ARG:0))
	ELSE
		TFLAG:63 = 0
		CALL DAMAGE_COMMON(ARG:0, 2, 8000 + RAND:4001, 100)
		TFLAG:63 = 1
		CALL DAMAGE_COMMON(ARG:0, 2, 8000 + RAND:4001, 100)
		TFLAG:63 = 2
		CALL DAMAGE_COMMON(ARG:0, 2, 8000 + RAND:4001, 100)
		TFLAG:63 = 3
		CALL DAMAGE_COMMON(ARG:0, 2, 8000 + RAND:4001, 100)
		CALL PRINT_MESSAGE(ARG:0, 507, 1, CALLNAME:1, CALLNAME:(ARG:0))
	ENDIF
	
;罵倒してもらう
ELSEIF RESULT == 19 && CFLAG:(ARG:0):43 && CFLAG:1:29 == 0
	CALL PRINT_MESSAGE(ARG:0, 507, 3, CALLNAME:1, CALLNAME:(ARG:0))
	BASE:1:4 += 20
	SIF BASE:1:4 > 200
		BASE:1:4 = 200
	BASE:1:1 += MAXBASE:1:1 / 15
	SIF BASE:1:1 > MAXBASE:1:1
		BASE:1:1 = MAXBASE:1:1
		
;踏んでもらう
ELSEIF RESULT == 20 && CFLAG:(ARG:0):43 && CFLAG:1:29 == 0
	CALL PRINT_MESSAGE(ARG:0, 507, 4, CALLNAME:1, CALLNAME:(ARG:0))
	TFLAG:63 = 0
	CALL DAMAGE_COMMON(1, 2, 800 + RAND:3001, 100)
	TFLAG:63 = 1
	CALL DAMAGE_COMMON(1, 2, 800 + RAND:3001, 100)
	TFLAG:63 = 2
	CALL DAMAGE_COMMON(1, 2, 800 + RAND:3001, 100)
	TFLAG:63 = 3
	CALL DAMAGE_COMMON(1, 2, 800 + RAND:3001, 100)
	BASE:1:1 += MAXBASE:1:1 / 15
	SIF BASE:1:1 > MAXBASE:1:1
		BASE:1:1 = MAXBASE:1:1
	CALL ADD_ABL_EXP(13,1, 3 + RAND:5)
	CALL ADD_ABL_EXP(13,(ARG:0), 3 + RAND:5)
	
;ドリンクに睡眠薬を仕込む
ELSEIF RESULT == 21 && (ITEM:52 > 0 || ITEM:53 > 0) && ITEM:65 > 0
	BASE:(ARG:0):0 = MAXBASE:(ARG:0):0
	BASE:(ARG:0):1 = MAXBASE:(ARG:0):1
	CFLAG:(ARG:0):5 += RAND:30
	CFLAG:(ARG:0):25 = 2
	IF ITEM:52 > 0
		CALL ADD_ITEM(52, -1, 0)
	ELSEIF ITEM:53 > 0
		CALL ADD_ITEM(53, -1, 0)
	ENDIF
	;口上を呼び出さないように一時的に喪失もつける
	CFLAG:(ARG:0):29 = 1
	;戦意喪失に分岐が近いので飛ばす
	CALL TALK_2(ARG:0)
	
;勃起を治療する
ELSEIF RESULT == 22 && GET_PENIS(ARG:0) > 0
	CALL NPC_RAPE_2(ARG:0)
	IF FLAG:AUTOMODE
		TWAIT FLAG:AUTOMODE * 500, 0
	ELSE
		WAIT
	ENDIF
	
;ペットに「食べさせる」
ELSEIF RESULT == 23 && PET:0 && CFLAG:(ARG:0):43
	PRINTFORML %CALLNAME:1%は%CALLNAME:(ARG:0)%に、身体を%PETNAME%に捧げさせた……
	FOR LOCAL, 0, RAND:5 + 1
		LOCAL:2 = RAND:5
		TRYCALLFORM FIX_PT_ACTION_{54 + LOCAL:2}(ARG:0)
		CFLAG:(ARG:0):50 = 54 + LOCAL:2
		CALL PET_RAPE(ARG:0)
		CFLAG:(ARG:0):5 -= RAND:5 + 5
	NEXT
	;主人公がペットか花嫁だと一緒になって捧げられる
	IF TALENT:1:140
		PRINTFORML %CALLNAME:1%は負けじと%PETNAME%に身体を捧げた！
		FOR LOCAL, 0, RAND:5 + 1
			LOCAL:2 = RAND:5
			TRYCALLFORM FIX_PT_ACTION_{54 + LOCAL:2}(1)
			CFLAG:(1):50 = 54 + LOCAL:2
			CALL PET_RAPE(1)
			;謎の親近感
			CFLAG:(ARG:0):5 += RAND:5
		NEXT
	ENDIF
	
;結婚報告をする
ELSEIF RESULT == 24 && PET:0 && TALENT:1:140 == 2 && CFLAG:(ARG:0):180 == 0
	CFLAG:(ARG:0):180 = 1
	CALL PRINT_MESSAGE(1, 229, 0, CALLNAME:1, CALLNAME:(ARG:0))
	CALL PRINT_MESSAGE(ARG:0, 229, 1, CALLNAME:(ARG:0), CALLNAME:1)
	GOTO TALK_START
;一緒にペットに体を捧げる
ELSEIF RESULT == 25 && PET:0 && TALENT:1:140
	PRINTFORML %CALLNAME:1%は笑顔で%CALLNAME:(ARG:0)%に、一緒に身体を捧げようと言い出した……
	
	CALLFORM PRINT_MESSAGE(1, 514, 1, CALLNAME:1, PETNAME)
	;淫乱かペット系素質を所持、又は高好感度なら身体を捧げる
	IF TALENT:(ARG:0):74 || TALENT:(ARG:0):140 || CFLAG:(ARG:0):5 > 200
		CALLFORM PRINT_MESSAGE(ARG:0, 514, 1, CALLNAME:(ARG:0), PETNAME)
	;それ以外はレイプ
	ELSE
		CALLFORM PRINT_MESSAGE(ARG:0, 514, 0, CALLNAME:(ARG:0), PETNAME)
	ENDIF
	
	
	FOR LOCAL, 0, RAND:5 + 1
		
		;主人公はおねだり確定
		LOCAL:2 = RAND:5
		TRYCALLFORM FIX_PT_ACTION_{54 + LOCAL:2}(1)
		CFLAG:(1):50 = 54 + LOCAL:2
		CALL PET_RAPE(1)
		
		;主人公と部位を変える
		LOCAL:2 = RAND:5
		;淫乱かペット系素質を所持、又は高好感度なら3Pを楽しむのでおねだり
		IF TALENT:(ARG:0):74 || TALENT:(ARG:0):140 || CFLAG:(ARG:0):5 > 200
			TRYCALLFORM FIX_PT_ACTION_{54 + LOCAL:2}(ARG:0)
			CFLAG:(ARG:0):50 = 54 + LOCAL:2
		ENDIF
		CALL PET_RAPE(ARG:0)
		
		;淫乱かペット系素質を所持、又は高好感度なら好感度上昇
		IF TALENT:(ARG:0):74 || TALENT:(ARG:0):140 || CFLAG:(ARG:0):5 > 200
			CFLAG:(ARG:0):5 += RAND:5 + 3
		;貞操無頓着か触手中毒Lv3で微変化
		ELSEIF TALENT:(ARG:0):31 || ABL:(ARG:0):11 > 2
			CFLAG:(ARG:0):5 += RAND:5 - RAND:5
		;それ以外は減少
		ELSE
			CFLAG:(ARG:0):5 -= RAND:10
		ENDIF
		
	NEXT
;キスをする
ELSEIF RESULT == 30 && CFLAG:1:29 == 0 && ABL:1:13 > 0
	CALL NPC_KISS(ARG:0)
	TWAIT FLAG:AUTOMODE * 200, 0
	
;能力を見る
ELSEIF RESULT == 110
	CALL SHOW_PERSONAL_STATUS(ARG:0)
	GOTO TALK_START
	
ELSE
	REUSELASTLINE 入力値が不正です。再入力してください
	GOTO INPUT_LOOP
	
ENDIF

;催眠・睡眠・一服盛った時の喪失を一時的にする
CFLAG:(ARG:0):43 = 0
CFLAG:(ARG:0):25 = 0
SIF CFLAG:(ARG:0):29 == 1 && BASE:(ARG:0):1 > 0
	CFLAG:(ARG:0):29 = 0

;露出癖入手抽選
IF TALENT:1:167 == 0 && BASE:1:3 <= 0 && BASE:1:4 >= 100
	CALL GET_EXHIBITIONIST(1)
ENDIF
IF TALENT:(ARG:0):167 == 0 && BASE:(ARG:0):3 <= 0 && BASE:(ARG:0):4 >= 100
	CALL GET_EXHIBITIONIST(ARG:0)
ENDIF

;≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡
;◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆
;≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡
;TALK_EV_1(会話)
;ARG:0	相手キャラID
;≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡
@TALK_EV_1(ARG)
;無難に友好度を稼ぐことができる
;MPが少し回復する効果もある

#DIM LCOUNT,3	;ループ用
#DIM PTID,3

PTID:0 = 1
PTID:1 = FLAG:10
PTID:2 = FLAG:11

;---友好度上昇---
;相手が強気な程上がりやすい
LOCAL = 3 + RAND:5
IF CFLAG:(ARG):12 >= 40
	LOCAL += 1 + RAND:5
ELSEIF CFLAG:(ARG):12 >= 20
	LOCAL += RAND:5
ELSEIF CFLAG:(ARG):12 >= -19
	LOCAL += RAND:3
ENDIF
CFLAG:(ARG):友好度 += LOCAL

;話術上昇
CALL ADD_ABL_EXP_PT(2, 700)

;話し相手がいるので常に「達」
;寄生されたおなかが目立つので分岐
CALL PRINT_MESSAGE(1, 103, ARG, CALLNAME:(PTID), CALLNAME:(ARG), 1)

;MP小回復
FOR LCOUNT, 0, 3
	IF PTID:(LCOUNT) > 0 && CFLAG:(PTID:(LCOUNT)):戦意喪失 == 0
		BASE:(PTID:(LCOUNT)):MP = MIN(BASE:(PTID:(LCOUNT)):MP + MAXBASE:(PTID:(LCOUNT)):MP / 20, MAXBASE:(PTID:(LCOUNT)):MP)
	ENDIF
NEXT
TWAIT FLAG:AUTOMODE * 200, 0

;固定イベントのうち、位置が固定されているイベントの情報が得られる場合アリ
;主人公の話術が高い・相手の探索技能が高いほど聞きやすい
;また、捕食されているNPCの情報が得られる場合アリ　ただしこちらは詳細不明
CALL TALK_GETINFO(ARG, 0)

;≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡
;TALK_EV_2(情報交換)
;ARG:0	相手キャラID
;≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡
@TALK_EV_2(ARG)
;近くのマスに誰が居るのかや、一部の固定イベントの発生場所などを知ることができる
;若干友好度を稼ぐこともできる


#DIM LCOUNT,3	;ループ用
#DIM PTID,3

PTID:0 = 1
PTID:1 = FLAG:10
PTID:2 = FLAG:11



;---友好度上昇---
;相手が強気な程上がりやすい
LOCAL = RAND:3
IF CFLAG:(ARG):12 <= -40
	LOCAL += 1 + RAND:4
ELSEIF CFLAG:(ARG):12 <= -20
	LOCAL += RAND:4
ENDIF
CFLAG:(ARG):友好度 += LOCAL


;話術上昇
CALL ADD_ABL_EXP_PT(2, 700)

;話し相手がいるので常に「達」
CALL PRINT_MESSAGE(1, 104, ARG, CALLNAME:(PTID), CALLNAME:(ARG), 0)

;!!!現状では固定イベントが未実装なので、周囲のキャラ情報のみ
FOR LCOUNT, 0, 4
	;四方について、半々の確率で教えてくれる
	;１つも教えて貰えなくても泣かないこと
	IF RAND:100 < 50
		CALL PRINT_SEARCH_INFO_2(LCOUNT)
		IF RESULT > 0
			IF RESULT:1
				PRINTFORML 【 {RESULT} の部屋 】には今は誰も居ないらしい…
			ELSE
				PRINTFORML 【 {RESULT} の部屋 】には%STR:1%
			ENDIF
		ENDIF
	ENDIF
NEXT

TWAIT FLAG:AUTOMODE * 200, 0


;固定イベントのうち、位置が固定されていないイベントの情報が得られる場合アリ
;また、脱出イベントを開始している場合、そちらの情報も得られる場合アリ
;主人公の話術が高い・相手の探索技能が高いほど聞きやすい
;また、捕食されているNPCの情報が得られる場合アリ　こちらはキャラなどの詳細つき
CALL TALK_GETINFO(ARG, 1)



;≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡
;TALK_EV_3(アイテム強請)
;ARG:0	相手キャラID
;≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡
@TALK_EV_3(ARG)
;友好度を代償に、アイテムを貰う
;ただし、ある程度友好度が高い状態でないと何も貰えず、友好度が下がるだけ
;非常に友好度が高い状態だと、良い物が貰えることがある

#DIM LCOUNT,3	;ループ用
#DIM PTID,3

PTID:0 = 1
PTID:1 = FLAG:10
PTID:2 = FLAG:11



CALL PRINT_MESSAGE(1, 138, ARG:0, CALLNAME:1, CALLNAME:(ARG:0))
IF CFLAG:(ARG:0):5 > 200 && RAND:100 < CFLAG:(ARG:0):5 / 10
	CALL FUTANARI_H_ITEM_GIVE(ARG:0, 0)
	IF RESULT == 1
	
		;友好度と引き換えに良い物が貰える
		CFLAG:(ARG:0):5 -= 15 + RAND:15
		
		CALL GIFT_ITEM(1)
		LOCAL:2 = RESULT
		CALL ADD_ITEM(LOCAL:2, 1, 0)
		
		PRINTFORM %CALLNAME:(ARG:0)%は抱かせてくれたお礼に%ITEMNAME:(LOCAL:2)%
		
		CALL GIFT_ITEM(1)
		LOCAL:2 = RESULT
		CALL ADD_ITEM(LOCAL:2, 1, 0)
		PRINTFORML と%ITEMNAME:(LOCAL:2)%を渡してくれた！
		CALL WAIT_AUTOMODE(700 , 0)
		
	ELSEIF RESULT == 2
	
		;友好度と引き換えに良い物が貰える（たまに貰えない）
		CFLAG:(ARG:0):5 -= 15 + RAND:15
		IF RAND:100 < 20
			
			PRINTFORML それならばアイテムも渡せないと断られてしまった…
			CALL WAIT_AUTOMODE(600 , 0)
		ELSE
			;良い物が貰える
			CALL GIFT_ITEM(1)
			LOCAL:2 = RESULT
			CALL ADD_ITEM(LOCAL:2, 1, 0)
			CALL ADD_ABL_EXP_PT(2, 500)
			PRINTFORML %CALLNAME:(ARG:0)%は少し残念そうに%ITEMNAME:(LOCAL:2)%を渡してくれた！
			CALL WAIT_AUTOMODE(400, 0)
		ENDIF
	ELSE
	
		;友好度と引き換えに良い物が貰える
		CFLAG:(ARG:0):5 -= 15 + RAND:15
		CALL GIFT_ITEM(1)
		LOCAL:2 = RESULT
		CALL ADD_ITEM(LOCAL:2, 1, 0)
		
		CALL ADD_ABL_EXP_PT(2, 500)
		CALL PRINT_MESSAGE(ARG:0, 139, LOCAL:2, CALLNAME:1, CALLNAME:(ARG:0))
		CALL PRINT_MESSAGE(1, 105, ARG:0, CALLNAME:1, CALLNAME:(ARG:0), LOCAL:2)
		
	ENDIF
ELSEIF CFLAG:(ARG:0):5 > 120 && RAND:100 < LIMIT(CFLAG:(ARG:0):5 - 100, 20, 75)
	CALL FUTANARI_H_ITEM_GIVE(ARG:0, 1)
	IF RESULT == 1
	
		;友好度と引き換えに普通の物が貰える
		CFLAG:(ARG:0):5 -= 10 + RAND:10
		CALL GIFT_ITEM(0)
		LOCAL:2 = RESULT
		CALL ADD_ITEM(LOCAL:2, 1, 0)
		
		CALL ADD_ABL_EXP_PT(2, 700)
		PRINTFORM %CALLNAME:(ARG:0)%は体の礼に%ITEMNAME:(LOCAL:2)%を渡してくれた！
	ELSEIF RESULT == 2
	
		;友好度と引き換えに普通の物が貰える（たまに貰えない）
		CFLAG:(ARG:0):5 -= 10 + RAND:10
		IF RAND:100 < 80
			PRINTFORML それならばアイテムも渡せないと断られてしまった…
			CALL WAIT_AUTOMODE(400, 0)
		ELSE
			CALL GIFT_ITEM(0)
			LOCAL:2 = RESULT
			CALL ADD_ITEM(LOCAL:2, 1, 0)
			
			CALL ADD_ABL_EXP_PT(2, 700)
			PRINTFORM %CALLNAME:(ARG:0)%は渋々ながら%ITEMNAME:(LOCAL:2)%を渡してくれた！
		ENDIF
	ELSE
	
		;友好度と引き換えに普通の物が貰える
		CFLAG:(ARG:0):5 -= 10 + RAND:10
		CALL GIFT_ITEM(0)
		LOCAL:2 = RESULT
		CALL ADD_ITEM(LOCAL:2, 1, 0)
		CALL ADD_ABL_EXP_PT(2, 700)
		CALL PRINT_MESSAGE(ARG:0, 139, LOCAL:2, CALLNAME:1, CALLNAME:(ARG:0))
		CALL PRINT_MESSAGE(1, 105, ARG:0, CALLNAME:1, CALLNAME:(ARG:0), LOCAL:2)
	ENDIF
ELSE
	CALL FUTANARI_H_ITEM_GIVE(ARG:0, 2)
	IF RESULT == 1
		PRINTFORML 
		PRINTFORML 行為を終え、身支度を整えてからアイテムをねだると%CALLNAME:(ARG:0)%はアイテムを渡すとは言っていないと言った
		
		IF FLAG:AUTOMODE
			PRINTFORML どうやら性欲の発散だけが目的だったようだ…
			TWAIT FLAG:AUTOMODE * 600 , 0
		ELSE
			PRINTFORML どうやら性欲の発散だけが目的だったようだ…
			CALL WAIT_AUTOMODE(400, 0)
			PRINTFORMW 
		ENDIF
	ELSEIF RESULT == 2
		
		PRINTFORML それならばアイテムも渡せないと断られてしまった…
		CALL WAIT_AUTOMODE(600 , 0)
	ELSE
		CFLAG:(ARG:0):5 -= 5 + RAND:5
		CALL ADD_ABL_EXP_PT(2, 1500)
		CALL PRINT_MESSAGE(ARG:0, 139, 0, CALLNAME:1, CALLNAME:(ARG:0))
		CALL PRINT_MESSAGE(1, 106, ARG:0, CALLNAME:1, CALLNAME:(ARG:0))
	ENDIF
ENDIF



;≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡
;TALK_EV_4(仲間に誘う)
;ARG:0	相手キャラID
;≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡
@TALK_EV_4(ARG)
;パーティーメンバーを増やすための基本
;デフォルトでもそれなり、原作で相性の良いキャラならほぼ仲間に入ってくれる（戦闘素質が近い場合）
;共闘してたり、拘束されている所を助けたりしていると一気に友好度が上がるので、大体仲間になる


CALL GET_INVITE_RATE(ARG:0, 0)
IF RAND:100 < RESULT
	CALL ADD_ABL_EXP_PT(2, 700)
	CALL PRINT_MESSAGE(ARG:0, 140, 0, CALLNAME:1, CALLNAME:(ARG:0), 1)
	CALL PRINT_MESSAGE(1, 107, ARG:0, CALLNAME:1, CALLNAME:(ARG:0))
	CFLAG:(ARG:0):5 += 10
	CALL PRINT_MESSAGE(ARG:0, 109, 0, CALLNAME:(ARG:0), CALLNAME:(ARG:0))
	IF FLAG:10 == 0
		FLAG:10 = ARG:0
	ELSEIF FLAG:11 == 0
		FLAG:11 = ARG:0
	ELSE
		PRINTFORMW (TALK) PT加入処理エラー！{ARG:0}/{FLAG:10}/{FLAG:11}
	ENDIF
	
	;キャラが加入した場合、位置と目的地を主人公に合わせておく
	CFLAG:(ARG:0):4 = CFLAG:1:4
	CFLAG:(ARG:0):13 = CFLAG:1:13
	CFLAG:(ARG:0):14 = CFLAG:1:14
	
	;好感度を最低50に調整
	SIF CFLAG:(ARG:0):5 < 50
		CFLAG:(ARG:0):5 = 50

	SIF CFLAG:(ARG:0):43
		CFLAG:(ARG:0):43 = 0
	;ED追加
	CALL ADD_HISTORY(DAY, ARG:0,, 4)
	CALL RANDOM_ESTRUS_INITIALIZE(ARG:0)
ELSE
	CALL ADD_ABL_EXP_PT(2, 1500)
	CALL PRINT_MESSAGE(ARG:0, 140, 0, CALLNAME:1, CALLNAME:(ARG:0), 0)
	CALL PRINT_MESSAGE(1, 108, ARG:0, CALLNAME:1, CALLNAME:(ARG:0))
	;でもちょっと嬉しい
	CFLAG:(ARG:0):5 += 2
ENDIF


;≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡

