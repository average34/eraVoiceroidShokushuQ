;キス
;ARG:0	対象キャラ
@NPC_KISS(ARG:0)
;LOCAL
;0	LOOP
;1	キスポイント
;2	EPダメージ

;お互いの状態で勝手に派生

;好感度　100が基準値なので少し厳し目
LOCAL:1 += CFLAG:(ARG:0):5 - 130
;レズ中毒
LOCAL:1 += (ABL:1:13 + ABL:(ARG:0):13) * 30
;話術　レズ中毒2以上
SIF ABL:1:13 > 1
	LOCAL:1 += ABL:1:2 * 20
;各種素質補正
SIF TALENT:(ARG:0):20
	LOCAL:1 -= 10
SIF TALENT:(ARG:0):23
	LOCAL:1 += 10
SIF TALENT:(ARG:0):27
	LOCAL:1 -= 10
SIF TALENT:(ARG:0):35
	LOCAL:1 -= 10
SIF TALENT:(ARG:0):54
	LOCAL:1 -= 20
SIF TALENT:(ARG:0):70
	LOCAL:1 += 10
SIF TALENT:(ARG:0):71
	LOCAL:1 -= 10
SIF TALENT:(ARG:0):72
	LOCAL:1 += 10
SIF TALENT:(ARG:0):74
	LOCAL:1 += 10
SIF TALENT:(ARG:0):79
	LOCAL:1 += 10
SIF TALENT:(ARG:0):81
	LOCAL:1 += 10
SIF TALENT:(ARG:0):157
	LOCAL:1 += 100
;発情
LOCAL:1 += CFLAG:(ARG:0):28 * 20
;催眠
SIF CFLAG:(ARG:0):43
	LOCAL:1 += 100
;弱っているかどうか
SIF BASE:(ARG:0):0 < 1000
	LOCAL:1 += 20
SIF BASE:(ARG:0):1 < 1000
	LOCAL:1 += 20
SIF BASE:(ARG:0):4 < 50
	LOCAL:1 += 10
;ブレ
LOCAL:1 += RAND:16 - RAND:16

;MP小回復だが中毒感覚増加
IF LOCAL:1 > 20
	BASE:1:1 += MAXBASE:1:1 / 12
	SIF BASE:1:1 > MAXBASE:1:1
		BASE:1:1 = MAXBASE:1:1
	BASE:(ARG:0):1 += MAXBASE:(ARG:0):1 / 12
	SIF BASE:(ARG:0):1 > MAXBASE:(ARG:0):1
		BASE:(ARG:0):1 = MAXBASE:(ARG:0):1
ENDIF
IF LOCAL:1 > 60
	CFLAG:(ARG:0):5 += ABL:(ARG:0):13 + 2 + RAND:6
ENDIF

;場合分け
IF LOCAL:1 <= 20
	CALL PRINT_MESSAGE(1, 464, 0, CALLNAME:1,CALLNAME:(ARG:0), LOCAL:2, ARG:0)
	CALL PRINT_MESSAGE(ARG:0, 464, 1, CALLNAME:1,CALLNAME:(ARG:0), LOCAL:2, ARG:0)
ELSEIF LOCAL:1 <= 40
	CALL PRINT_MESSAGE(1, 464, 2, CALLNAME:1,CALLNAME:(ARG:0), LOCAL:2, ARG:0)
	CALL PRINT_MESSAGE(ARG:0, 464, 3, CALLNAME:1,CALLNAME:(ARG:0), LOCAL:2, ARG:0)
	CALL ADD_ABL_EXP(13, 1, 1 + RAND:3)
	CALL ADD_ABL_EXP(13, ARG:0, 1 + RAND:3)
	CALL ADD_ABL_EXP(15, ARG:0, 30 + RAND:50)
	EXP:(ARG:0):24 += 1
ELSEIF LOCAL:1 <= 60
	CALL PRINT_MESSAGE(1, 464, 4, CALLNAME:1,CALLNAME:(ARG:0), LOCAL:2, ARG:0)
	CALL PRINT_MESSAGE(ARG:0, 464, 5, CALLNAME:1,CALLNAME:(ARG:0), LOCAL:2, ARG:0)
	CALL ADD_ABL_EXP(13, 1, 1 + RAND:3)
	CALL ADD_ABL_EXP(13, ARG:0, 1 + RAND:3)
	CALL ADD_ABL_EXP(15, 1, 30 + RAND:50)
	CALL ADD_ABL_EXP(15, ARG:0, 30 + RAND:50)
	EXP:1:24 += 2
	EXP:(ARG:0):24 += 2
ELSEIF LOCAL:1 <= 80
	CALL PRINT_MESSAGE(1, 464, 6, CALLNAME:1,CALLNAME:(ARG:0), LOCAL:2, ARG:0)
	CALL PRINT_MESSAGE(ARG:0, 464, 7, CALLNAME:1,CALLNAME:(ARG:0), LOCAL:2, ARG:0)
	CALL ADD_ABL_EXP(13, 1, 3 + RAND:3)
	CALL ADD_ABL_EXP(13, ARG:0, 3 + RAND:3)
	CALL ADD_ABL_EXP(15, 1, 40 + RAND:50)
	CALL ADD_ABL_EXP(15, ARG:0, 40 + RAND:50)
	EXP:1:24 += 2
	EXP:(ARG:0):24 += 2
;ダメージを受けだす
ELSEIF LOCAL:1 <= 120
	CALL PRINT_MESSAGE(1, 464, 8, CALLNAME:1,CALLNAME:(ARG:0), LOCAL:2, ARG:0)
	CALL PRINT_MESSAGE(ARG:0, 464, 9, CALLNAME:1,CALLNAME:(ARG:0), LOCAL:2, ARG:0)
	TFLAG:63 = 9
	CALL DAMAGE_COMMON(1, 2, 800 + RAND:1001, 100)
	CALL DAMAGE_COMMON(ARG:0, 2, 800 + RAND:2001, 100)
	CALL ADD_ABL_EXP(13, 1, 6 + RAND:3)
	CALL ADD_ABL_EXP(13, ARG:0, 3 + RAND:3)
	EXP:1:24 += 4
	EXP:(ARG:0):24 += 4
ELSEIF LOCAL:1 <= 140
	CALL PRINT_MESSAGE(1, 464, 10, CALLNAME:1,CALLNAME:(ARG:0), LOCAL:2, ARG:0)
	CALL PRINT_MESSAGE(ARG:0, 464, 11, CALLNAME:1,CALLNAME:(ARG:0), LOCAL:2, ARG:0)
	TFLAG:63 = 9
	CALL DAMAGE_COMMON(1, 2, 500 + RAND:4001, 100)
	CALL DAMAGE_COMMON(ARG:0, 2, 500 + RAND:4001, 100)
	CALL ADD_ABL_EXP(13, 1, 8 + RAND:3)
	CALL ADD_ABL_EXP(13, ARG:0, 8 + RAND:3)
	EXP:1:24 += 4
	EXP:(ARG:0):24 += 4
;一定以上なら2つからランダム
ELSEIF LOCAL:1 <= 160 || RAND:2 == 0
	CALL PRINT_MESSAGE(1, 464, 12, CALLNAME:1,CALLNAME:(ARG:0), LOCAL:2, ARG:0)
	CALL PRINT_MESSAGE(ARG:0, 464, 13, CALLNAME:1,CALLNAME:(ARG:0), LOCAL:2, ARG:0)
	TFLAG:63 = 1
	CALL DAMAGE_COMMON(1, 2, 1200 + RAND:3001, 100)
	CALL DAMAGE_COMMON(ARG:0, 2, 1200 + RAND:3001, 100)
	TFLAG:63 = 9
	CALL DAMAGE_COMMON(1, 2, 1500 + RAND:4001, 100)
	CALL DAMAGE_COMMON(ARG:0, 2, 1500 + RAND:4001, 100)
	CALL ADD_ABL_EXP(13, 1, 10 + RAND:3)
	CALL ADD_ABL_EXP(13, ARG:0, 10 + RAND:3)
	EXP:1:24 += 4
	EXP:(ARG:0):24 += 4
ELSE
	CALL PRINT_MESSAGE(1, 464, 14, CALLNAME:1,CALLNAME:(ARG:0), LOCAL:2, ARG:0)
	CALL PRINT_MESSAGE(ARG:0, 464, 15, CALLNAME:1,CALLNAME:(ARG:0), LOCAL:2, ARG:0)
	TFLAG:63 = 2
	CALL DAMAGE_COMMON(1, 2, 1200 + RAND:2501, 100)
	CALL DAMAGE_COMMON(ARG:0, 2, 1200 + RAND:2501, 100)
	TFLAG:63 = 3
	CALL DAMAGE_COMMON(1, 2, 1200 + RAND:2501, 100)
	CALL DAMAGE_COMMON(ARG:0, 2, 1200 + RAND:2501, 100)
	TFLAG:63 = 9
	CALL DAMAGE_COMMON(1, 2, 1800 + RAND:3001, 100)
	CALL DAMAGE_COMMON(ARG:0, 2, 1800 + RAND:3001, 100)
	CALL ADD_ABL_EXP(13, 1, 14 + RAND:3)
	CALL ADD_ABL_EXP(13, ARG:0, 14 + RAND:3)
	EXP:1:24 += 4
	EXP:(ARG:0):24 += 4
ENDIF

CALL GET_KISSER(1)
CALL GET_KISSER(ARG:0)

