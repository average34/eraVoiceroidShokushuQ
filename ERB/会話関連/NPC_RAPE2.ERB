;治療
;基本的に主人公をいじめる場合はこっち
;NPCいじめはNPC_RAPE
;ARG:0	対象キャラ
@NPC_RAPE_2(ARG:0)
#DIM HOW_NUKINUKI
#DIM LCOUNT	;ループ用
#DIM LOCALQUETE,10000
#DIM LOCALIDNUM
#DIM LOCALIDNUM_COUNT
#DIM LOCALRESULT
#DIM NUMBER_OF_VICTIM_RESULT,10000


VARSET LOCALQUETE
VARSET LOCALIDNUM
VARSET LOCALIDNUM_COUNT

LOCALRESULT = 1

;LOCAL
;1	ループ上限
;5	ダメージ計算用
;7	ダメージ計算用2

	PRINTFORML どうやって治療しますか？
	
	SIF ABL:1:14 > 2
		PRINTFORML [ 1] V
	SIF ABL:1:14 > 1
		PRINTFORML [10] B
	SIF ABL:1:14 > 1
		PRINTFORML [20] A
	SIF ABL:1:14 > 0
		PRINTFORML [30] 口
	SIF ABL:1:14 > 0 && CFLAG:(ARG:0):5 > 200 && GET_PENIS(1) > 0
		PRINTFORML [31] 69

	
	PRINTFORML [40] 手
	PRINTFORML [45] 足
	SIF FLAG:507 > 0 && TALENT:1:162 >= 3 && GET_BUST(1) >= 1
		PRINTFORML [46] N
	
	IF CFLAG:(ARG:0):29 == 1 && FLAG:507 > 0
		PRINTFORML [50] 折る
		IF TALENT:(ARG:0):180
			PRINTFORML [51] 玉潰し
		ENDIF
	ENDIF

	PRINTFORML [0] やめる
	$INPUT_LOOP
	IF FLAG:AUTOMODE
	
		;条件1つ追加ごとに
		;LOCALQUETE:LOCALIDNUM = XX
		;LOCALIDNUM += 1
		;LOCALIDNUM_COUNT += 1
		;と書けば良し（XXは空いている番号）

		LOCALQUETE:LOCALIDNUM = 40
		LOCALIDNUM += 1

		LOCALQUETE:LOCALIDNUM = 45
		LOCALIDNUM += 1

		IF ABL:1:14 > 0 && CFLAG:(ARG:0):5 > 200 && GET_PENIS(1) > 0
			LOCALQUETE:LOCALIDNUM = 69
			LOCALIDNUM += 1
		ENDIF
		IF ABL:1:14 > 2
			LOCALQUETE:LOCALIDNUM = 1
			LOCALIDNUM += 1
		ENDIF
		IF ABL:1:14 > 1
			LOCALQUETE:LOCALIDNUM = 10
			LOCALIDNUM += 1
		ENDIF
		IF ABL:1:14 > 1
			LOCALQUETE:LOCALIDNUM = 10
			LOCALIDNUM += 1
		ENDIF
		IF ABL:1:14 > 0
			LOCALQUETE:LOCALIDNUM = 30
			LOCALIDNUM += 1
		ENDIF


		HOW_NUKINUKI = LOCALQUETE:(RAND:LOCALIDNUM)

		TINPUT FLAG:AUTOMODE * 1000, HOW_NUKINUKI, 0, ""
	ELSE
		INPUT
	ENDIF

IF RESULT == 0
		RETURN
ELSEIF RESULT == 1 && ABL:1:14 > 2

		CALL PRINT_MESSAGE(ARG:0, 459, 0, CALLNAME:1,CALLNAME:(ARG:0))
		CALL PRINT_MESSAGE(1, 461, 0, CALLNAME:(ARG:0),CALLNAME:1, ARG:0)

		TFLAG:63 = 3
		LOCAL:5 = CALC_SENSITIVITY(1, TFLAG:63, 2500 + RAND:2001)
		LOCAL:5 = LOCAL:5 * (4 + 2 * (TALENT:(ARG:0):170 + TALENT:(ARG:0):171) + TALENT:(ARG:0):185) / 4
		SIF LOCAL:5 > 20000
			LOCAL:5 = 20000 + RAND:((LOCAL:5 - 19970) / 30)
		CALL DAMAGE_COMMON(1, 2, LOCAL:5, 100)
		LOCAL:1 = ABL:1:14 + 2
		FOR  LCOUNT,0,LOCAL:1
			TFLAG:63 = 2
			CALL DAMAGE_COMMON(ARG:0, 2, RAND:(LOCAL:1 * 1000), 100)
			CALL LOST_VIRGIN(1, 0, 2, ARG:0)
		NEXT
		
		CALL ADD_ABL_EXP(9, 1, RAND:(LOCAL:1 * 1000))
		CALL ADD_ABL_EXP(13, 1, LOCAL:1 * 2)
		CALL ADD_ABL_EXP(13, ARG:0, LOCAL:1 * 2)
		CALL ADD_ABL_EXP(14, 1, LOCAL:1 * (2 + TALENT:(ARG:0):185))
		CFLAG:(ARG:0):5 += 10

	IF CFLAG:1:22 == 0 && RAND:4 == 0
		;生まれるのはシェイプシフター
		CALL PARASITE_TYPE(1, 1, 17, 8 + LIMIT(RAND:4 + RAND:4 + RAND:4 + RAND:4, 1, 10), 2, 1)
	ENDIF

ELSEIF RESULT == 10 && ABL:1:14 > 1

		CALL PRINT_MESSAGE(ARG:0, 459, 1, CALLNAME:1,CALLNAME:(ARG:0))
		CALL PRINT_MESSAGE(1, 461, 1, CALLNAME:(ARG:0),CALLNAME:1, ARG:0)

		TFLAG:63 = 1
		LOCAL:5 = CALC_SENSITIVITY(1, TFLAG:63, 2000 + RAND:1501)
		LOCAL:5 = LOCAL:5 * (3 + TALENT:(ARG:0):170 + TALENT:(ARG:0):171 + TALENT:(ARG:0):185) / 3
		SIF LOCAL:5 > 20000
			LOCAL:5 = 20000 + RAND:((LOCAL:5 - 19970) / 30)
		CALL DAMAGE_COMMON(1, 2, LOCAL:5, 100)
		LOCAL:1 = ABL:1:14 + 2
		FOR  LCOUNT,0,LOCAL:1
			TFLAG:63 = 2
			CALL DAMAGE_COMMON(ARG:0, 2, RAND:(LOCAL:1 * 1000), 100)
		NEXT
		
		CALL ADD_ABL_EXP(7, 1, RAND:(LOCAL:1 * 1000))
		CALL ADD_ABL_EXP(13, 1, LOCAL:1 * 2)
		CALL ADD_ABL_EXP(13, ARG:0, LOCAL:1 * 2)
		CALL ADD_ABL_EXP(14, 1, LOCAL:1 * (2 + TALENT:(ARG:0):185))
		CFLAG:(ARG:0):5 += 10


ELSEIF RESULT == 20 && ABL:1:14 > 1

		CALL PRINT_MESSAGE(ARG:0, 459, 2, CALLNAME:1,CALLNAME:(ARG:0))
		CALL PRINT_MESSAGE(1, 461, 2, CALLNAME:(ARG:0),CALLNAME:1, ARG:0)

		TFLAG:63 = 0
		LOCAL:5 = CALC_SENSITIVITY(1, TFLAG:63, 2500 + RAND:2001)
		LOCAL:5 = LOCAL:5 * (4 + 2 * (TALENT:(ARG:0):170 + TALENT:(ARG:0):171) + TALENT:(ARG:0):185) / 4
		SIF LOCAL:5 > 20000
			LOCAL:5 = 20000 + RAND:((LOCAL:5 - 19970) / 30)
		CALL DAMAGE_COMMON(1, 2, LOCAL:5, 100)
		LOCAL:1 = ABL:1:14 + 2
		FOR  LCOUNT,0,LOCAL:1
			TFLAG:63 = 2
			CALL DAMAGE_COMMON(ARG:0, 2, 8000 + RAND:4001, 100)
		NEXT
		
		CALL ADD_ABL_EXP(6, 1, RAND:(LOCAL:1 * 1000))
		CALL ADD_ABL_EXP(13, 1, LOCAL:1 * 2)
		CALL ADD_ABL_EXP(13, ARG:0, LOCAL:1 * 2)
		CALL ADD_ABL_EXP(14, 1, LOCAL:1 * (2 + TALENT:(ARG:0):185))
		CFLAG:(ARG:0):5 += 10

ELSEIF RESULT == 30 && ABL:1:14 > 0

		CALL PRINT_MESSAGE(ARG:0, 459, 3, CALLNAME:1,CALLNAME:(ARG:0))
		CALL PRINT_MESSAGE(1, 461, 3, CALLNAME:(ARG:0),CALLNAME:1, ARG:0)

		TFLAG:63 = 9
		CALL DAMAGE_COMMON(1, 2, 2000 + ( RAND:901 + 600 ) * (ABL:1:14 + ABL:1:15 + 2 * TALENT:1:106 + 4 * TALENT:1:79), 100)
		LOCAL:1 = ABL:1:14 + 2
		FOR  LCOUNT,0,LOCAL:1
			TFLAG:63 = 2
			CALL DAMAGE_COMMON(ARG:0, 2, 8000 + RAND:4001, 100)
		NEXT
		
		CALL ADD_ABL_EXP(15, 1, RAND:(LOCAL:1 * 1000))
		CALL ADD_ABL_EXP(13, 1, LOCAL:1 * 2)
		CALL ADD_ABL_EXP(13, ARG:0, LOCAL:1 * 2)
		CALL ADD_ABL_EXP(14, 1, LOCAL:1 * (2 + TALENT:(ARG:0):185))
		CFLAG:(ARG:0):5 += 10
ELSEIF RESULT == 31 && ABL:1:14 > 0 && CFLAG:(ARG:0):5 > 200 && GET_PENIS(1) > 0


		CALL PRINT_MESSAGE(ARG:0, 459, 5, CALLNAME:1,CALLNAME:(ARG:0))
		CALL PRINT_MESSAGE(1, 461, 5, CALLNAME:(ARG:0),CALLNAME:1, ARG:0)

		TFLAG:63 = 9
		CALL DAMAGE_COMMON(1, 2, 1500 + ( RAND:501 + 200 ) * (ABL:1:14 + ABL:1:15 + 2 * TALENT:1:106 + 4 * TALENT:1:79), 100)
		CALL DAMAGE_COMMON(ARG:0, 2, 1500 + ( RAND:501 + 200 ) * (ABL:(ARG:0):14 + ABL:(ARG:0):15 + 2 * TALENT:(ARG:0):106 + 4 * TALENT:(ARG:0):79), 100)
		LOCAL:1 = ABL:1:14 + 2
		FOR  LCOUNT,0,LOCAL:1
			TFLAG:63 = 2
			CALL DAMAGE_COMMON(ARG:0, 2, 8000 + RAND:4001, 100)
			CALL DAMAGE_COMMON(1, 2, 8000 + RAND:4001, 100)
		NEXT
		
		CALL ADD_ABL_EXP(15, 1, RAND:(LOCAL:1 * 1000))
		CALL ADD_ABL_EXP(15, ARG:0, RAND:(LOCAL:1 * 1000))
		CALL ADD_ABL_EXP(13, 1, LOCAL:1 * 2)
		CALL ADD_ABL_EXP(13, ARG:0, LOCAL:1 * 2)
		CALL ADD_ABL_EXP(14, 1, LOCAL:1 * (2 + TALENT:(ARG:0):185))
		CALL ADD_ABL_EXP(14, ARG:0, LOCAL:1 * (2 + TALENT:1:185))
		CFLAG:(ARG:0):5 += 5 + ABL:(ARG:0):13
ELSEIF RESULT == 40

		CALL PRINT_MESSAGE(ARG:0, 459, 4, CALLNAME:1,CALLNAME:(ARG:0))
		CALL PRINT_MESSAGE(1, 461, 4, CALLNAME:(ARG:0),CALLNAME:1, ARG:0)
		LOCAL:1 = ABL:1:14 + 2
		FOR  LCOUNT,0,LOCAL:1
			TFLAG:63 = 2
			CALL DAMAGE_COMMON(ARG:0, 2, 8000 + RAND:4001, 100)
		NEXT
		
		CALL ADD_ABL_EXP(13, 1, LOCAL:1 * 2)
		CALL ADD_ABL_EXP(13, ARG:0, LOCAL:1 * 2)
		CALL ADD_ABL_EXP(14, 1, LOCAL:1 * (2 + TALENT:(ARG:0):185))
		CFLAG:(ARG:0):5 += 10
ELSEIF RESULT == 45
	IF CFLAG:1:29 == 0
		CALL PRINT_MESSAGE(ARG:0, 144, 10, CALLNAME:1, CALLNAME:(ARG:0))
	ELSEIF CFLAG:1:29 == 1 && FLAG:10 && CFLAG:(FLAG:10):29 == 0
		CALL PRINT_MESSAGE(ARG:0, 144, 10, CALLNAME:(FLAG:10), CALLNAME:(ARG:0))
	ELSE
		CALL PRINT_MESSAGE(ARG:0, 144, 10, CALLNAME:(FLAG:11), CALLNAME:(ARG:0))
	ENDIF
	TFLAG:63 = 2
	FOR LCOUNT,0,(RAND:7 + 2)
		CALL DAMAGE_COMMON(ARG:0, 2, 8000 + RAND:4001, 100)
	NEXT
	IF CFLAG:1:29 == 0
		CALL PRINT_MESSAGE(ARG:0, 144, 11, CALLNAME:1, CALLNAME:(ARG:0))
	ELSEIF CFLAG:1:29 == 1 && FLAG:10 && CFLAG:(FLAG:10):29 == 0
		CALL PRINT_MESSAGE(ARG:0, 144, 11, CALLNAME:(FLAG:10), CALLNAME:(ARG:0))
	ELSE
		CALL PRINT_MESSAGE(ARG:0, 144, 11, CALLNAME:(FLAG:11), CALLNAME:(ARG:0))
	ENDIF
	CALL ADD_ABL_EXP_PT(13, 3 + RAND:5)
	CFLAG:(ARG:0):5 -= 10
;N
ELSEIF RESULT == 46 && FLAG:507 > 0 && TALENT:1:162 >= 3 && GET_BUST(1) >= 1

		;素質LVによるダメージ補正
		LOCAL:7 = 100 + CALC_NF_DAMAGE(1, 6)
		CALL PRINT_MESSAGE(ARG:0, 459, 11, CALLNAME:1,CALLNAME:(ARG:0), 1)

		TFLAG:63 = 1
		LOCAL:5 = CALC_SENSITIVITY(1, TFLAG:63, 3000 + RAND:2001)
		LOCAL:5 = LOCAL:5 * (3 + TALENT:(ARG:0):170 + TALENT:(ARG:0):171 + TALENT:(ARG:0):185) *LOCAL:7/100 / 3
		SIF LOCAL:5 > 30000
			LOCAL:5 = 30000 + RAND:((LOCAL:5 - 29955) / 30)
		CALL DAMAGE_COMMON(1, 2, LOCAL:5, 100)
		LOCAL:1 = ABL:1:14 + 2
		FOR  LCOUNT,0,LOCAL:1
			TFLAG:63 = 2
			CALL DAMAGE_COMMON(ARG:0, 2, RAND:(LOCAL:1 * 1000), 100)
		NEXT
		
		CALL ADD_ABL_EXP(7, 1, RAND:(LOCAL:1 * 1000))
		CALL ADD_ABL_EXP(13, 1, LOCAL:1 * 2)
		CALL ADD_ABL_EXP(13, ARG:0, LOCAL:1 * 2)
		CALL ADD_ABL_EXP(14, 1, LOCAL:1 * (2 + TALENT:(ARG:0):185))
		CFLAG:(ARG:0):5 += 10
		CFLAG:1:512 += 1

		CALL PRINT_MESSAGE(1, 531, 0, CALLNAME:(1),CALLNAME:(ARG:0), ARG:0)

ELSEIF RESULT == 50 && CFLAG:(ARG:0):29 == 1
	CALL PRINT_MESSAGE(ARG:0, 144, 9, CALLNAME:1, CALLNAME:(ARG:0))
	;キャン玉付きのチンコを折るとヴォッキ出現フラグ（玉潰しでは出現しない）
	SIF TALENT:(ARG:0):180
		FLAG:994 = 1
	TFLAG:63 = 2
	FOR LCOUNT,0,(RAND:7 + 2)
		CALL DAMAGE_COMMON(ARG:0, 2, 80000 + RAND:40001, 100)
	NEXT
	;Cダメージ後取れる
	SIF CFLAG:(ARG:0):42 > 0
		CFLAG:(ARG:0):42 = 0
	SIF TALENT:(ARG:0):121
		TALENT:(ARG:0):121 = 0
	CFLAG:(ARG:0):5 -= 50
ELSEIF RESULT == 50 && CFLAG:(ARG:0):29 == 1 && TALENT:(ARG:0):180
	IF TALENT:(ARG:0):180 > 0 && TALENT:(ARG:0):180  < 10
		TALENT:(ARG:0):180 += 10
	ELSEIF TALENT:(ARG:0):180  > 10
		TALENT:(ARG:0):180 = 0
		TALENT:(ARG:0):181 = 0
	ENDIF
	CALL PRINT_MESSAGE(ARG:0, 459, 51, CALLNAME:1, CALLNAME:(ARG:0))
	TFLAG:63 = 2
	FOR LCOUNT,0,(RAND:7 + 2)
		CALL DAMAGE_COMMON(ARG:0, 2, 80000 + RAND:40001, 100)
	NEXT
	CFLAG:(ARG:0):5 -= 100
ELSE
	CLEARLINE 1
	REUSELASTLINE 入力が不正です！
	GOTO INPUT_LOOP
ENDIF
