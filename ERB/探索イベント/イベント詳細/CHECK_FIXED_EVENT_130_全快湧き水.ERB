;固定イベント
;RETURN	0:失敗した　1:成功した　2:以後のイベントスキップ
@CHECK_FIXED_EVENT_130
;LOCAL
;0	LOOP
;1	目標値
;2	達成値
;3	戻り値

LOCAL:3 = 0

;目標値（イベント難易度）決定
LOCAL:1 = 50


;達成値決定
CALL GET_SEARCH_RATE
LOCAL:2 = RESULT


IF LOCAL:2 >= LOCAL:1
	;飲むのをキャンセルした場合、何度も経験値が入るという小技
	CALL ADD_ABL_EXP_PT(0, 500)
	PRINTFORML 湧き水を発見した！　飲んでみますか？
	CALL ASK_YN
	IF RESULT == 0
		;飲む場合、イベント削除
		FLAG:130 = 0
		
		PRINTFORML %CALLNAME:1%%TACHI()%は湧き水を飲んでみた…
		PRINTFORML 冷たくて美味しい水を飲み、パーティーのHP・MP・EPが全回復した！
		CALL PRINT_MESSAGE(1, 200, 130, CALLNAME:1, "")
		CALL PRINT_MESSAGE(FLAG:10, 200, 130, CALLNAME:1, "")
		CALL PRINT_MESSAGE(FLAG:11, 200, 130, CALLNAME:1, "")
		BASE:1:0 = MAXBASE:1:0
		BASE:1:1 = MAXBASE:1:1
		BASE:1:2 = MAXBASE:1:2
		
		;尿意追加
		CALL ADD_BASE_NP(1,3)
		
		IF FLAG:10
			BASE:(FLAG:10):0 = MAXBASE:(FLAG:10):0
			BASE:(FLAG:10):1 = MAXBASE:(FLAG:10):1
			BASE:(FLAG:10):2 = MAXBASE:(FLAG:10):2
			
			;尿意追加
			CALL ADD_BASE_NP(FLAG:10,3)
			
		ENDIF
		IF FLAG:11
			BASE:(FLAG:11):0 = MAXBASE:(FLAG:11):0
			BASE:(FLAG:11):1 = MAXBASE:(FLAG:11):1
			BASE:(FLAG:11):2 = MAXBASE:(FLAG:11):2
			
			;尿意追加
			CALL ADD_BASE_NP(FLAG:11,3)
			
		ENDIF
		CALL WAIT_AUTOMODE(400, 0)
	ELSE
		;飲まない場合、イベントは残す
		CALL PRINT_MESSAGE(1, 200, 130, CALLNAME:1, "", 1)
		CALL PRINT_MESSAGE(FLAG:10, 200, 130, CALLNAME:1, "", 1)
		CALL PRINT_MESSAGE(FLAG:11, 200, 130, CALLNAME:1, "", 1)
	ENDIF
	LOCAL:3 = 1
ELSE
	;見つからなかった場合（通常は何もしない）
ENDIF

RETURN LOCAL:3

