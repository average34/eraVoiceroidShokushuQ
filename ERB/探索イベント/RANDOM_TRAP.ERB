;探索時のランダムイベントで発生するトラップ
@RANDOM_TRAP
;基本的に既存の何度も発生するトラップを流用

;学園モードだとイベント変更
IF FLAG:学園
	CALL RANDOM_TRAP_S
	RETURN RESULT
ENDIF


;★EXでは荷物袋トラップは発生しない。敵を増やさないために
IF FLAG:998 || FLAG:999
	SELECTCASE RAND:47
	CASE 0 TO 1
		CALL CHECK_FIXED_EVENT_EX1
	CASE 2 TO 3
		CALL CHECK_FIXED_EVENT_136
	CASE 4 TO 6
		CALL CHECK_FIXED_EVENT_137
	CASE 7 TO 9
		CALL CHECK_FIXED_EVENT_138
	CASE 10 TO 11
		CALL CHECK_FIXED_EVENT_140
	CASE 12 TO 13
		CALL CHECK_FIXED_EVENT_143
	CASE 14 TO 15
		CALL CHECK_FIXED_EVENT_144
	CASE 16 TO 17
		CALL CHECK_FIXED_EVENT_146
	CASE 18 TO 19
		CALL CHECK_FIXED_EVENT_147
	CASE 20 TO 21
		CALL CHECK_FIXED_EVENT_148
	CASE 22 TO 23
		CALL CHECK_FIXED_EVENT_149
	CASE 24 TO 25
		CALL CHECK_FIXED_EVENT_150
	CASE 26 TO 28
		CALL CHECK_FIXED_EVENT_152
	CASE 29 TO 31
		CALL CHECK_FIXED_EVENT_163
	CASE 32
		CALL CHECK_FIXED_EVENT_161
	CASE 33
		CALL CHECK_FIXED_EVENT_EX2
	CASE 34 TO 36
		CALL CHECK_FIXED_EVENT_153
	CASE 38 TO 40
		CALL CHECK_FIXED_EVENT_154
	CASE 41 TO 42
		CALL CHECK_FIXED_EVENT_174
	CASE 43 TO 44
		CALL CHECK_FIXED_EVENT_175
	CASEELSE
		CALL CHECK_FIXED_EVENT_135
	ENDSELECT
ELSE
	SELECTCASE RAND:48
	CASE 0 TO 1
		CALL CHECK_FIXED_EVENT_EX1
	CASE 2 TO 3
		CALL CHECK_FIXED_EVENT_EX2
	CASE 4 TO 6
		CALL CHECK_FIXED_EVENT_135
	CASE 7 TO 9
		CALL CHECK_FIXED_EVENT_136
	CASE 10 TO 11
		CALL CHECK_FIXED_EVENT_137
	CASE 12 TO 13
		CALL CHECK_FIXED_EVENT_138
	CASE 14 TO 15
		CALL CHECK_FIXED_EVENT_140
	CASE 16 TO 17
		CALL CHECK_FIXED_EVENT_141
	CASE 18 TO 19
		CALL CHECK_FIXED_EVENT_143
	CASE 20 TO 21
		CALL CHECK_FIXED_EVENT_144
	CASE 22 TO 23
		CALL CHECK_FIXED_EVENT_146
	CASE 24 TO 25
		CALL CHECK_FIXED_EVENT_147
	CASE 26 TO 27
		CALL CHECK_FIXED_EVENT_148
	CASE 28 TO 30
		CALL CHECK_FIXED_EVENT_149
	CASE 31 TO 32
		CALL CHECK_FIXED_EVENT_150
	CASE 33 TO 34
		CALL CHECK_FIXED_EVENT_152
	CASE 34 TO 35
		CALL CHECK_FIXED_EVENT_153
	CASE 36 TO 37
		CALL CHECK_FIXED_EVENT_154
	CASE 38 TO 39
		CALL CHECK_FIXED_EVENT_161
	CASE 40 TO 41
		CALL CHECK_FIXED_EVENT_163
	CASE 42 TO 43
		CALL CHECK_FIXED_EVENT_174
	CASE 44 TO 45
		CALL CHECK_FIXED_EVENT_175
	CASEELSE
		IF FLAG:4 > 1
			CALL CHECK_FIXED_EVENT_171
		ELSE
			CALL CHECK_FIXED_EVENT_135
		ENDIF
	ENDSELECT
ENDIF

RETURN RESULT


;使い魔が勝手に発動させる罠
@RANDOM_TRAP_2

;学園モードだとイベント変更
IF FLAG:学園
	CALL RANDOM_TRAP_2_S
	RETURN RESULT
ENDIF

;罠の種類を減らす テレポートとか無理
SELECTCASE RAND:26
CASE 0 TO 1
	CALL CHECK_FIXED_EVENT_136
CASE 2 TO 3
	CALL CHECK_FIXED_EVENT_137
CASE 4 TO 5
	CALL CHECK_FIXED_EVENT_138
CASE 6 TO 7
	CALL CHECK_FIXED_EVENT_143
CASE 8 TO 9
	CALL CHECK_FIXED_EVENT_146
CASE 10 TO 11
	CALL CHECK_FIXED_EVENT_148
CASE 12 TO 13
	CALL CHECK_FIXED_EVENT_149
CASE 14 TO 15
	CALL CHECK_FIXED_EVENT_152
CASE 16 TO 17
		CALL CHECK_FIXED_EVENT_153
CASE 18 TO 19
		CALL CHECK_FIXED_EVENT_154
CASE 20 TO 21
	CALL CHECK_FIXED_EVENT_EX2
CASEELSE
	CALL CHECK_FIXED_EVENT_147
ENDSELECT

RETURN RESULT


;トラップモード　固定罠も含めてマイナス効果をランダムに出す
@RANDOM_TRAP_3

;学園モードだとイベント変更
IF FLAG:学園
	CALL RANDOM_TRAP_3_S
	RETURN RESULT
ENDIF

	SELECTCASE RAND:50
	CASE 0 TO 1
		CALL CHECK_FIXED_EVENT_EX1
	CASE 2 TO 3
		CALL CHECK_FIXED_EVENT_131
	CASE 4 TO 6
		CALL CHECK_FIXED_EVENT_136
	CASE 7 TO 9
		CALL CHECK_FIXED_EVENT_137
	CASE 10 TO 11
		CALL CHECK_FIXED_EVENT_138
	CASE 12 TO 13
		CALL CHECK_FIXED_EVENT_139
	CASE 14 TO 19
		CALL CHECK_FIXED_EVENT_143
	CASE 20 TO 21
		CALL CHECK_FIXED_EVENT_144
	CASE 22 TO 23
		CALL CHECK_FIXED_EVENT_146
	CASE 24 TO 25
		CALL CHECK_FIXED_EVENT_147
	CASE 26 TO 27
		CALL CHECK_FIXED_EVENT_148
	CASE 28 TO 30
		CALL CHECK_FIXED_EVENT_149
	CASE 31 TO 32
		CALL CHECK_FIXED_EVENT_150
	CASE 33 TO 34
		CALL CHECK_FIXED_EVENT_152
	CASE 34 TO 35
		CALL CHECK_FIXED_EVENT_153
	CASE 36 TO 37
		CALL CHECK_FIXED_EVENT_154
	CASE 38 TO 39
		CALL CHECK_FIXED_EVENT_161
	CASE 40 TO 41
		CALL CHECK_FIXED_EVENT_163
	CASE 42 TO 43
		CALL CHECK_FIXED_EVENT_174
	CASE 44 TO 45
		CALL CHECK_FIXED_EVENT_175
	CASE 46 TO 47
		CALL CHECK_FIXED_EVENT_176
	CASEELSE
		CALL CHECK_FIXED_EVENT_180
	ENDSELECT
