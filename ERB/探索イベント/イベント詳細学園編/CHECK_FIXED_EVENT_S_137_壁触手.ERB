;固定イベント
;RETURN	0:失敗した　1:成功した　2:以後のイベントスキップ
@CHECK_FIXED_EVENT_S_137
;LOCAL
;0	LOOP
;1	目標値
;2	達成値
;3	戻り値
;4	被害者あり
;5	TEMP
;6	TEMP

LOCAL:3 = 0

;目標値（イベント難易度）決定
LOCAL:1 = 0


;達成値決定
CALL GET_SEARCH_RATE
LOCAL:2 = RESULT


IF LOCAL:2 >= LOCAL:1
	CALL ADD_ABL_EXP_PT(0, 300)
	PRINTFORML 探索していると、突然壁から触手が伸びてきた！
	CALL WAIT_AUTOMODE(400, 0)
	PRINTFORML 
	LOCAL:4 = 0
	CALL REACTION_TRAP(1)
	IF 90 > RAND:(100 + ABL:1:5 * 50) && RESULT == 1
		CALL ADD_ABL_EXP(5, 1, 1000 + RAND:(ABL:1:5 * 500 + 1))
		CALL PRINT_MESSAGE(1, 200, 137, CALLNAME:1, "", 1)
		LOCAL:5 = 2 + RAND:4
		FOR LOCAL:0, 0, LOCAL:5
			LOCAL:6 = RAND:4
			IF LOCAL:6 == 3
				CALL LOST_VIRGIN(1, 1, 4)
			ENDIF
			CALL EXTASY(1, LOCAL:6, RAND:50, 200)
		NEXT
		LOCAL:4 = 1
		CALL WAIT_AUTOMODE(400, 0)
	ELSE
		CALL ADD_ABL_EXP(5, 1, 500 + RAND:(ABL:1:5 * 200 + 1))
		CALL PRINT_MESSAGE(1, 200, 137, CALLNAME:1, "", 2)
	ENDIF
	IF FLAG:10
		CALL REACTION_TRAP(FLAG:10)
		IF 90 > RAND:(100 + ABL:(FLAG:10):5 * 50) && RESULT == 1
			CALL ADD_ABL_EXP(5, FLAG:10, 1000 + RAND:(ABL:(FLAG:10):5 * 500 + 1))
			CALL PRINT_MESSAGE(FLAG:10, 200, 137, CALLNAME:1, "", 1)
			LOCAL:5 = 2 + RAND:4
			FOR LOCAL:0, 0, LOCAL:5
				LOCAL:6 = RAND:4
				IF LOCAL:6 == 3
					CALL LOST_VIRGIN(FLAG:10, 1, 4)
				ENDIF
				CALL EXTASY(FLAG:10, LOCAL:6, RAND:50, 200)
			NEXT
			LOCAL:4 = 1
			CALL WAIT_AUTOMODE(400, 0)
		ELSE
			CALL ADD_ABL_EXP(5, FLAG:10, 500 + RAND:(ABL:(FLAG:10):5 * 200 + 1))
			CALL PRINT_MESSAGE(FLAG:10, 200, 137, CALLNAME:1, "", 2)
		ENDIF
	ENDIF
	IF FLAG:11
		CALL REACTION_TRAP(FLAG:11)
		IF 90 > RAND:(100 + ABL:(FLAG:11):5 * 50) && RESULT == 1
			CALL ADD_ABL_EXP(5, FLAG:11, 1000 + RAND:(ABL:(FLAG:11):5 * 500 + 1))
			CALL PRINT_MESSAGE(FLAG:11, 200, 137, CALLNAME:1, "", 1)
			LOCAL:5 = 2 + RAND:4
			FOR LOCAL:0, 0, LOCAL:5
				LOCAL:6 = RAND:4
				IF LOCAL:6 == 3
					CALL LOST_VIRGIN(FLAG:11, 1, 4)
				ENDIF
				CALL EXTASY(FLAG:11, LOCAL:6, RAND:50, 200)
			NEXT
			LOCAL:4 = 1
			CALL WAIT_AUTOMODE(400, 0)
		ELSE
			CALL ADD_ABL_EXP(5, FLAG:11, 500 + RAND:(ABL:(FLAG:10):5 * 200 + 1))
			CALL PRINT_MESSAGE(FLAG:11, 200, 137, CALLNAME:1, "", 2)
		ENDIF
	ENDIF
	
	IF LOCAL:4
		PRINTFORML 
		PRINTFORML 何とか触手を振りほどいた%CALLNAME:1%%TACHI()%は、急いでその場から離れた…
	ELSE
		PRINTFORML 
		PRINTFORML 何とか触手を避けきった%CALLNAME:1%%TACHI()%は、急いでその場から離れた…
	ENDIF
	
	CALL WAIT_AUTOMODE(400, 0)
	
	;別の場所に再配置
	FLAG:137 = RAND:30 + 1
	LOCAL:3 = 1
ELSE
	;見つからなかった場合（通常は何もしない）
ENDIF

RETURN LOCAL:3

