;通常の会話イベント
;ARG:0	対象キャラ
@MINIGAME_PENALTY_2(ARG:0)
;LOCAL
;0	LOOP

;5-6	HP低下
;7-8	MP低下
;9		CP低下
;10		寄生

LOCAL:3 = RAND:48
	SELECTCASE LOCAL:3
		CASE 0
			CALL ENEMY_ATTACK(ARG:0,802,1)
		CASE 1
			CALL ENEMY_ATTACK(ARG:0,807,3)
		CASE 2
			CALL ENEMY_ATTACK(ARG:0,809,4)
		CASE 3
			CALL ENEMY_ATTACK(ARG:0,811,5)
		CASE 4
			CALL ENEMY_ATTACK(ARG:0,815,7)
		CASE 5
			CALL ENEMY_ATTACK(ARG:0,819,9)
		CASE 6
			CALL ENEMY_ATTACK(ARG:0,824,11)
		CASE 7
			CALL ENEMY_ATTACK(ARG:0,826,12)
		CASE 8
			CALL ENEMY_ATTACK(ARG:0,828,13)
		CASE 9
			CALL ENEMY_ATTACK(ARG:0,835,17)
		CASE 10
			CALL ENEMY_ATTACK(ARG:0,838,18)
		CASE 11
			CALL ENEMY_ATTACK(ARG:0,840,98)
		CASE 12
			CALL ENEMY_ATTACK(ARG:0,841,31)
		CASE 13
			CALL ENEMY_ATTACK(ARG:0,845,45)
		CASE 14
			CALL ENEMY_ATTACK(ARG:0,847,45)
		CASE 15
			CALL ENEMY_ATTACK(ARG:0,851,46)
		CASE 16
			CALL ENEMY_ATTACK(ARG:0,854,52)
		CASE 17
			CALL ENEMY_ATTACK(ARG:0,959,21)
		CASE 18 TO 27
			TFLAG:63 = 3
			CALL PRINT_MESSAGE((ARG:0), 200, 149, CALLNAME:(ARG:0), "")
			CALL LOST_VIRGIN((ARG:0), 1, 4)
			LOCAL:5 = CALC_SENSITIVITY((ARG:0), TFLAG:63, LOCAL:1)
			CALL DAMAGE_COMMON((ARG:0), 2, LOCAL:5 * 7 * (TALENT:(ARG:0):104 + 2) * (TALENT:(ARG:0):78 + 1), 500);◆
			IF RAND:5 == 0 && CFLAG:(ARG:0):22 == 0 && TALENT:(ARG:0):0 == 0
				IF RAND:2 == 0
					CALL RANDOM_PARASITE((ARG:0), 1, 0)
				ELSE
					CALL RANDOM_PARASITE((ARG:0), 0, 0)
					IF RESULT
						CALL PRINT_MESSAGE((ARG:0), 200, 149, CALLNAME:1, "", 2)
					ENDIF
				ENDIF
			ENDIF
			IF RAND:4 == 0 && TALENT:(ARG:0):104 <= 2
				PRINTFORMW %CALLNAME:(ARG:0)%の身体の様子がおかしい。どうやら、淫蟲の体液によって体質が書き換えられてしまったようだ…
				PRINTFORMW %CALLNAME:(ARG:0)%の膣内が少し敏感になった
				TALENT:(ARG:0):104 += 1
			ENDIF
		CASE 28 TO 37
			CALL PRINT_MESSAGE(ARG:0, 200, 160, CALLNAME:1, "", 2, 0)
			FOR LOCAL:0, 0, 20
				TFLAG:63 = 3
				LOCAL:5 = RAND:5
				CALL DAMAGE_COMMON(ARG:0, 2, 30*(LOCAL:5+10)* (TALENT:(ARG:0):(101+TFLAG:63) + 2), 50)
			NEXT
		
			CALL PRINT_MESSAGE(ARG:0, 200, 160, CALLNAME:1, "", 2, 1)
			IF CFLAG:(ARG:0):22 == 0
				CALL RANDOM_PARASITE((ARG:0), 1, 1)
			ENDIF
		CASE 38 TO 47
			PRINTFORMW 触手生物は突然%CALLNAME:(ARG:0)%を触手で絡め取った！
			CALL LOST_VIRGIN(ARG:0, 1, 4)
			CALL PRINT_MESSAGE(ARG:0, 200, 142, CALLNAME:(ARG:0), "", 2, 3)
			CALL EXTASY(ARG:0, 3, 900, 400)
			CALL EXTASY(ARG:0, 3, 900, 400)
			CALL EXTASY(ARG:0, 3, 900, 400)
			CALL EXTASY(ARG:0, 3, 900, 400)
			CALL EXTASY(ARG:0, 3, 900, 400)
			PRINTFORML 　
			PRINTFORMW ……
			PRINTFORMW …………
			PRINTFORMW 触手生物の責めが終わったとき、%CALLNAME:(ARG:0)%は恍惚の表情を浮かべ、\@ BASE:(ARG:0):3 <= 0 ? 激しく # 服の上から \@自分のヴァギナをかき回していた…
			IF TALENT:(ARG:0):74 == 0 || TALENT:(ARG:0):78 == 0
				PRINTFORMW %CALLNAME:(ARG:0)%は触手の責めに屈し、膣内での快楽に溺れてしまった
			ENDIF
			IF TALENT:(ARG:0):74 == 0
				PRINTFORMW %CALLNAME:(ARG:0)%は【%TALENTNAME:74%】を得た
				TALENT:(ARG:0):74 = 1
			ENDIF
			IF TALENT:(ARG:0):78 == 0
				PRINTFORMW %CALLNAME:(ARG:0)%は【%TALENTNAME:78%】を得た
				TALENT:(ARG:0):78 = 1
			ENDIF
		PRINTFORMW 　
	ENDSELECT

;妊娠処理
TFLAG:64 = MAX(TFLAG:64 * RESULT / 100, 1)
SIF CFLAG:(ARG:0):47 == 0
	CFLAG:(ARG:0):60 += TFLAG:64
IF RAND:(1 + CFLAG:(ARG:0):60) <= TFLAG:64
	IF TFLAG:93
		CFLAG:(ARG:0):57 = 5 + RAND:12
	ELSE
		CFLAG:(ARG:0):57 = DA:(TFLAG:52):0
	ENDIF
ENDIF
IF CFLAG:(ARG:0):60 && CFLAG:(ARG:0):22 == 0
	;触手中毒による増加
	CFLAG:(ARG:0):60 = CFLAG:(ARG:0):60 * (ABL:(ARG:0):11 + 2) / 2
	;蓬莱人か薬毒耐性で妊娠確率半減
	IF TALENT:(ARG:0):56 || TALENT:(ARG:0):128
		CFLAG:(ARG:0):60 /= 2
	ENDIF
	;母乳体質で確率倍加
	IF TALENT:(ARG:0):130
		CFLAG:(ARG:0):60 *= 2
	ENDIF
	;小柄体型or幼稚で確率少しダウン
	IF TALENT:(ARG:0):100 || TALENT:(ARG:0):132
		CFLAG:(TFLAG:54):60 = CFLAG:(ARG:0):60 * 8 / 10
	ENDIF
	
	LOCAL:3 = LIMIT((CFLAG:(ARG:0):60 + 15), 25, 70)
	LOCAL:3 = LIMIT((LOCAL:3 + (CFLAG:(ARG:0):60 / 50 * 5)), 25, 95)
	;処女は確率激減
	IF TALENT:(ARG:0):0
		LOCAL:3 /= 10
	ENDIF
	IF RAND:100 < LOCAL:3
		LOCAL:3 = 1
		FOR LOCAL:0, 0, (3 + CFLAG:(ARG:0):60 / 50)
			IF RAND:100 < 30
				LOCAL:3 = 2
			ENDIF
		NEXT
		CALL PARASITE_TYPE(ARG:0, 1, CFLAG:(ARG:0):57, 8 + LIMIT(RAND:4 + RAND:4 + RAND:4 + RAND:4, 1, 10), LOCAL:3)
	ENDIF
ENDIF

CFLAG:(ARG:0):57 = 0
CFLAG:(ARG:0):60 = 0

;出産処理　タイムリミットを多めに減らす
SIF CFLAG:(ARG:0):23
	CFLAG:(ARG:0):23 -= 2
CALL CHECK_PARASITE(ARG:0)
CALL CHECK_NINSHIN(ARG:0)
CALL CHECK_PARASITE_BOMB(ARG:0)
;子供の削除処理
FOR LOCAL:1, 0, VARSIZE("DA", 1)
	DA:(FLAG:1):(LOCAL:1) = 0
NEXT
;出産していたらメッセージ
IF CFLAG:(ARG:0):157 != EXP:(ARG:0):22
	CFLAG:(ARG:0):157 = EXP:(ARG:0):22
	PRINTFORML
	PRINTFORML 現在の出産回数 {EXP:(ARG:0):22}
	PRINTFORMW
ENDIF
