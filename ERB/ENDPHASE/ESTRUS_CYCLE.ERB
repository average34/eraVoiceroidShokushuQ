;発情周期チェック
;ARG:0	対象キャラ
@ESTRUS_CYCLE(ARG:0)
;LOCAL
;0	LOOP
;1	月経周期何日目か
;月経周期は面倒なので30日計算
;12～14が排卵直前なので一番危ない
;15～17が排卵日
;28～2が月経
;
;妊娠率は返す数値%なので射精量以下の確率に確定

;周期の30で割ったあまりから月経日を引くと最後の月経から何日目かが出る
;負の数値の場合は30を足してやって0～30で判別
LOCAL:1 = (DAY % 30) - CFLAG:(ARG:0):150
SIF LOCAL:1 < 0
	LOCAL:1 += 30

	IF FLAG:535 == 1 && TALENT:(ARG:0):137 == -1
		SELECTCASE LOCAL:1
			CASE 0 TO 29
				RETURN 3
		ENDSELECT
	ELSEIF FLAG:535 == 1 && TALENT:(ARG:0):137 == 1
		SELECTCASE LOCAL:1
			CASE 0 TO 2
				RETURN 15
			CASE 3 TO 6
				RETURN 50
			CASE 7 TO 10
				RETURN 70
			CASE 11 TO 14
				RETURN 150
			CASE 15 TO 17
				RETURN 100
			CASE 18 TO 21
				RETURN 60
			CASE 22 TO 24
				RETURN 60
			CASE 25 TO 27
				RETURN 40
			CASE 28 TO 29
				RETURN 15
		ENDSELECT
	ELSEIF FLAG:535 == 1 && TALENT:(ARG:0):137 == 2
		SELECTCASE LOCAL:1
			CASE 0 TO 2
				RETURN 15
			CASE 3 TO 5
				RETURN 50
			CASE 6 TO 9
				RETURN 70
			CASE 10 TO 14
				RETURN 150
			CASE 15 TO 18
				RETURN 100
			CASE 19 TO 22
				RETURN 60
			CASE 23 TO 26
				RETURN 60
			CASE 27 TO 29
				RETURN 40
		ENDSELECT
	ELSEIF FLAG:535 == 1 && TALENT:(ARG:0):137 == 3
		SELECTCASE LOCAL:1
			CASE 0 TO 29
				RETURN 150
		ENDSELECT
	ELSE
		SELECTCASE LOCAL:1
			CASE 0 TO 3
				RETURN 15
			CASE 4 TO 7
				RETURN 50
			CASE 8 TO 11
				RETURN 70
			CASE 12 TO 14
				RETURN 150
			CASE 15 TO 17
				RETURN 100
			CASE 18 TO 20
				RETURN 60
			CASE 21 TO 23
				RETURN 60
			CASE 24 TO 26
				RETURN 40
			CASE 27 TO 29
				RETURN 15
		ENDSELECT
ENDIF



