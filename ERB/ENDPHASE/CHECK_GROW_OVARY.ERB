;フェイズごとの卵巣成長チェック
@CHECK_GROW_OVARY(CHARA_ID)
#DIM CHARA_ID
;CHARA_ID	対象キャラID
;LOCAL
;0	LOOP
;1	メッセージ表示フラグ
;
;
;CFLAG:(CHARA_ID):508	素質成長管理用
;CFLAG:(CHARA_ID):509	封印卵巣判定	0:未使用,1:封印中,2:封印解除
;CFLAG:(CHARA_ID):510	封印卵巣前の出産回数
;CFLAG:(CHARA_ID):511	封印卵巣前の卵巣素質

;すでにメス嫁苗床卵巣まで成長していたら無効 卵巣パッチOFFでも無効
IF TALENT:(CHARA_ID):137 == 5
	RETURN
ELSEIF FLAG:535 == 0
	RETURN
ENDIF
;リタイアしてるなら黙る
SIF CFLAG:(CHARA_ID):2
	RETURN


LOCAL:1 = 0


;主人公と場所が違うかチェック
SIF CFLAG:(CHARA_ID):4 == CFLAG:1:4
	LOCAL:1 = 1


;メッセージ表示処理
IF LOCAL:1
	IF CFLAG:(CHARA_ID):509 == 1 && (EXP:(CHARA_ID):22 > CFLAG:(CHARA_ID):510)
		CALL PRINT_MESSAGE(CHARA_ID, 512, -2, CALLNAME:(CHARA_ID), "", 1)
	ELSE
		IF TALENT:(CHARA_ID):137 == 4 && EXP:(CHARA_ID):22 >= 40 && ABL:(CHARA_ID):11 >= 3 && CFLAG:(CHARA_ID):508 == 4
			CALL PRINT_MESSAGE(CHARA_ID, 512, 5, CALLNAME:(CHARA_ID), "", 1)
		ELSEIF TALENT:(CHARA_ID):137 == 3 && EXP:(CHARA_ID):22 >= 20 && ABL:(CHARA_ID):11 >= 3 && CFLAG:(CHARA_ID):508 == 3
			CALL PRINT_MESSAGE(CHARA_ID, 512, 4, CALLNAME:(CHARA_ID), "", 1)
		ELSEIF TALENT:(CHARA_ID):137 == 2 && EXP:(CHARA_ID):22 >= 10 && ABL:(CHARA_ID):11 >= 3 && CFLAG:(CHARA_ID):508 == 2
			CALL PRINT_MESSAGE(CHARA_ID, 512, 3, CALLNAME:(CHARA_ID), "", 1)
		ELSEIF TALENT:(CHARA_ID):137 == 1 && EXP:(CHARA_ID):22 >= 5 && ABL:(CHARA_ID):11 >= 3 && CFLAG:(CHARA_ID):508 == 1
			CALL PRINT_MESSAGE(CHARA_ID, 512, 2, CALLNAME:(CHARA_ID), "", 1)
		ELSEIF TALENT:(CHARA_ID):137 == 0 && EXP:(CHARA_ID):22 >= 2 && ABL:(CHARA_ID):11 >= 2 && CFLAG:(CHARA_ID):508 == 0
			CALL PRINT_MESSAGE(CHARA_ID, 512, 1, CALLNAME:(CHARA_ID), "", 1)
		ELSEIF TALENT:(CHARA_ID):137 == -1 && EXP:(CHARA_ID):22 >= 1 || (EXP:(CHARA_ID):20 >= 50 && EXP:(CHARA_ID):14 >= 50) && CFLAG:(CHARA_ID):508 == -1
			CALL PRINT_MESSAGE(CHARA_ID, 512, 0, CALLNAME:(CHARA_ID), "", 1)
		;ELSE
		;	CALL PRINT_MESSAGE(CHARA_ID, 512, -1, CALLNAME:(CHARA_ID), "", 1)
		ENDIF
	ENDIF
ENDIF

;素質成長処理
;卵巣が封印前よりも出産回数が増えていると封印解除
IF CFLAG:(CHARA_ID):509 == 1 && (EXP:(CHARA_ID):22 > CFLAG:(CHARA_ID):510)
	TALENT:(CHARA_ID):137 = CFLAG:(CHARA_ID):511
	CFLAG:(CHARA_ID):509 = 2
	CFLAG:(CHARA_ID):510 = 0
ENDIF	

;苗床卵巣 かつ 出産回数40以上 かつ 触手中毒Lv3以上
IF TALENT:(CHARA_ID):137 == 4 && EXP:(CHARA_ID):22 >= 40 && ABL:(CHARA_ID):11 >= 3
	TALENT:(CHARA_ID):137 = 5
	CFLAG:(CHARA_ID):508 = 5
;肥大化卵巣 かつ 出産回数20以上 かつ 触手中毒Lv3以上
ELSEIF TALENT:(CHARA_ID):137 == 3 && EXP:(CHARA_ID):22 >= 20 && ABL:(CHARA_ID):11 >= 3
	TALENT:(CHARA_ID):137 = 4
	CFLAG:(CHARA_ID):508 = 4
;異常排卵巣 かつ 出産回数10以上 かつ 触手中毒Lv3以上
ELSEIF TALENT:(CHARA_ID):137 == 2 && EXP:(CHARA_ID):22 >= 10 && ABL:(CHARA_ID):11 >= 3
	TALENT:(CHARA_ID):137 = 3
	CFLAG:(CHARA_ID):508 = 3
;活発卵巣 かつ 出産回数5以上 かつ 触手中毒Lv3以上
ELSEIF TALENT:(CHARA_ID):137 == 1 && EXP:(CHARA_ID):22 >= 5 && ABL:(CHARA_ID):11 >= 3
	TALENT:(CHARA_ID):137 = 2
	CFLAG:(CHARA_ID):508 = 2
;成熟卵巣 かつ 出産回数2以上 かつ 触手中毒Lv2以上
ELSEIF TALENT:(CHARA_ID):137 == 0 && EXP:(CHARA_ID):22 >= 2 && ABL:(CHARA_ID):11 >= 2
	TALENT:(CHARA_ID):137 = 1
	CFLAG:(CHARA_ID):508 = 1
;未熟卵巣
ELSEIF TALENT:(CHARA_ID):137 == -1 
	;出産回数1以上
	IF EXP:(CHARA_ID):22 >= 1
		TALENT:(CHARA_ID):137 = 0
		CFLAG:(CHARA_ID):508 = 0
	;絶頂経験50以上 かつ 精液経験50以上
	ELSEIF TALENT:(CHARA_ID):137 == -1 && EXP:(CHARA_ID):20 >= 50 && EXP:(CHARA_ID):14 >= 50
		TALENT:(CHARA_ID):137 = 0
		CFLAG:(CHARA_ID):508 = 0
	ENDIF
ENDIF

