;PTメンバーから抜ける
;ARG:0	何人目の仲間か（0：１人目（FLAG:10）　1：２人目（FLAG:11））
@MEMBER_EXIT(ARG:0)
;LOCAL
;0	LOOP
;1	対象キャラID

IF ARG:0 < 0 || ARG:0 > 1
	PRINTFORMW (MEMBER_EXIT)不正な引数が指定されました（{ARG:0}）
ENDIF

LOCAL:1 = FLAG:(10 + ARG:0)

IF LOCAL:1 == 0
	RETURN
ENDIF

FLAG:(10 + ARG:0) = 0

;２人目が居る状態で１人目を抜く場合、位置をずらしておく
IF ARG:0 == 0 && FLAG:11
	FLAG:10 = FLAG:11
	FLAG:11 = 0
ENDIF


;抜けるキャラの装備をひっぺがす
FOR LOCAL:0, 0, 3
	IF CFLAG:(LOCAL:1):(LOCAL:0 + 7)
		CALL ADD_ITEM(CFLAG:(LOCAL:1):(LOCAL:0 + 7), 1, 0)
		;消耗武器だった場合追加処理
		IF CFLAG:(LOCAL:1):(LOCAL:0 + 7) >= 1 && CFLAG:(LOCAL:1):(LOCAL:0 + 7) <= 9
			CALL ADD_ITEM(GET_BULLET_ITEMID(CFLAG:(LOCAL:1):(LOCAL:0 + 7)), -GET_MAX_BULLET(CFLAG:(LOCAL:1):(LOCAL:0 + 7)), 0)
			CALL ADD_ITEM(GET_BULLET_ITEMID(CFLAG:(LOCAL:1):(LOCAL:0 + 7)), CFLAG:(LOCAL:1):(LOCAL:0 + 17), 0)
		ENDIF
		CFLAG:(LOCAL:1):(LOCAL:0 + 7) = 0
		CFLAG:(LOCAL:1):(LOCAL:0 + 17) = 0
	ENDIF
NEXT


;キャラID指定版のMEMBER_EXIT
@MEMBER_EXIT_ID(ARG:0)

IF ARG:0 == 0
	RETURN
ELSEIF ARG:0 == 1
	RETURN
ELSEIF ARG:0 == FLAG:10
	CALL MEMBER_EXIT(0)
ELSEIF ARG:0 == FLAG:11
	CALL MEMBER_EXIT(1)
ENDIF


