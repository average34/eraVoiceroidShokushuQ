@PET_CHECK_PREGNANCY
#DIM LCOUNT
VARSET LOCAL
;妊娠チェック
FOR LCOUNT, 0, CHARANUM
	IF CFLAG:LCOUNT:401 && CFLAG:LCOUNT:22 == 0
		;触手中毒による増加
		CFLAG:LCOUNT:401 = CFLAG:LCOUNT:401 * (ABL:LCOUNT:11 + 2) / 3
		;屈服度による補正
		CFLAG:LCOUNT:401 = CFLAG:LCOUNT:400 / 5
		;蓬莱人か薬毒耐性で妊娠確率さんぶんのいち
		SIF TALENT:LCOUNT:56 || TALENT:LCOUNT:128
			CFLAG:LCOUNT:401 /= 3
		;母乳体質で確率倍加
		SIF TALENT:LCOUNT:130
			CFLAG:LCOUNT:401 *= 2
		;ペットもちは孕みやすい
		SIF TALENT:LCOUNT:ペット
			CFLAG:LCOUNT:401 += 10
		;小柄体型or幼稚で確率少しダウン
		SIF TALENT:LCOUNT:100 || TALENT:LCOUNT:132
			CFLAG:(TFLAG:54):401 = CFLAG:LCOUNT:401 * 4 / 10
		LOCAL = LIMIT(CFLAG:LCOUNT:401, 10, 60)
		LOCAL = LIMIT((LOCAL + (CFLAG:LCOUNT:401 / 50 * 3)), 20, 70)
		;処女は確率激減
		SIF TALENT:LCOUNT:0
			LOCAL /= 10
		;************避妊パッチ********************	
		SIF CFLAG:LCOUNT:70
			LOCAL /= CFLAG:LCOUNT:70 * 25
		;******************************************

		IF RAND:100 < LOCAL
			LOCAL = 1
			FOR LOCAL:1, 0, (3 + CFLAG:LCOUNT:401 / 50)
				SIF RAND:100 < 30
					LOCAL = 2
			NEXT
			CALL PARASITE_TYPE(LCOUNT, 1, PET:0, 8 + LIMIT(RAND:4 + RAND:4 + RAND:4 + RAND:4, 1, 10), LOCAL)
			IF LOCAL == 2
				PRINTFORML %CALLNAME:LCOUNT%は%PETNAME%を熱いまなざしで見つめた……
				CALL WAIT_AUTOMODE(400, 0)
				CFLAG:LCOUNT:400 += 30
			ENDIF
		ENDIF
	ENDIF
	CFLAG:LCOUNT:401 = 0
NEXT