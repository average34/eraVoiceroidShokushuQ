@FIX_ENEMY_ACTION_759(ARG:0)

TFLAG:52 = ARG:0
TFLAG:54 = DA:(ARG:0):51
TFLAG:55 = 3
TFLAG:60 = 1

TFLAG:57 = DA:(ARG:0):5

TFLAG:58 = (4000 * (ABL:(TFLAG:54):14 * ABL:(TFLAG:54):14)) / (TFLAG:57 + 100)
;淫乱持ちは最大MPの割合でダメージ増加
SIF TALENT:(TFLAG:54):74 == 1
	TFLAG:58 = TFLAG:58 * (MAXBASE:(TFLAG:54):MP / (4000 + RAND:500))

TFLAG:61 = 120

TFLAG:64 = 500
TFLAG:65 = 10

TFLAG:59 = 0
TFLAG:90 = 200
TFLAG:91 = 1 + RAND:1
TFLAG:92 = 63
TFLAG:63 = 3

TFLAG:99 = 759

CALL ACTION_FILTER(-1, 4, 759, CALLNAME:(TFLAG:54), SAVESTR:(ARG:0), TFLAG:54, TFLAG:63)

@EXTRA_ACTION_759(ARG:0, ARG:1)
;面倒だけどこっちで全部の妊娠寄生処理をやる
TFLAG:52 = ARG:0
TFLAG:54 = DA:(ARG:0):51
TFLAG:55 = 5
TFLAG:60 = 1

TFLAG:65 = 60

;まずはA（産卵プレイコンフィグonのみ）
IF FLAG:533 > 0
	;Aおねだり中は確率60%増加
	IF CFLAG:(ARG:1):50 == 54
		LOCAL:0 = TFLAG:65 + 60
	;おねだり中は確率30%増加
	ELSEIF CFLAG:(ARG:1):50 >= 55 && CFLAG:(TFLAG:54):50 <= 58
		LOCAL:0 = TFLAG:65 + 30
	;おねだり無し
	ELSE
		LOCAL:0 = TFLAG:65
	ENDIF
	;体調や素質の補正
	IF FLAG:7 >= 11
		LOCAL:0 += 20
	ELSEIF FLAG:7 >= 7
		LOCAL:0 += 10
	ENDIF
	SIF TALENT:(ARG:1):132
		LOCAL:0 = LOCAL:5 / 2 + 1
	SIF TALENT:(ARG:1):136
		LOCAL:0 += 5
	IF RAND:100 < LOCAL:0
		CALL PARASITE_TYPE(ARG:1, 2, DA:(TFLAG:52):0, 4 + RAND:5 + RAND:5 + RAND:3, 0)
		CALL PRINT_MESSAGE(ARG:1, 40, TFLAG:52, CALLNAME:(ARG:1), SAVESTR:(TFLAG:52))
	ENDIF
ENDIF

;次にB（乳腺拡張必要）
IF TALENT:(ARG:1):162 > 1
	;先にNF経験増やしとく（B産卵offならNFのみ）
	CFLAG:(ARG:1):512 += 1
	IF FLAG:516 > 0
		;Bおねだり中は確率30％増加
		IF CFLAG:(ARG:1):50 == 55
			LOCAL:1 = TFLAG:65 + 30
		ELSE
			LOCAL:1 = TFLAG:65
		ENDIF
		;体調や素質の補正
		IF FLAG:7 >= 11
			LOCAL:1 += 20
		ELSEIF FLAG:7 >= 7
			LOCAL:1 += 10
		ENDIF
		SIF TALENT:(ARG:1):76
			LOCAL:1 += 5
		SIF TALENT:(ARG:1):132
			LOCAL:1 = LOCAL:5 / 2 + 1
		SIF TALENT:(ARG:1):136
			LOCAL:1 += 5
		SIF GET_BUST(ARG:1) == 1
			LOCAL:1 += 5
		SIF GET_BUST(ARG:1) == 2
			LOCAL:1 += 10
		SIF GET_BUST(ARG:1) == 3
			LOCAL:1 += 15 + LIMIT(TALENT:(ARG:1):158, 0, 5)
		SIF GET_BUST(ARG:1) == 4
			LOCAL:1 += 25 + LIMIT(TALENT:(ARG:1):222, 0, 5)
		SIF GET_BUST(ARG:1) >= 5
			LOCAL:1 += 35 + LIMIT(TALENT:(ARG:1):223, 0, 5)
		SIF TALENT:(ARG:1):162
			LOCAL:1 += TALENT:(ARG:1):162 * 10
		IF RAND:100 < LOCAL:1
			CALL PARASITE_TYPE(ARG:1, 3, DA:(TFLAG:52):0, 4 + RAND:5 + RAND:5 + RAND:3, 0)
			CALL PRINT_MESSAGE(ARG:1, 40, TFLAG:52, CALLNAME:(ARG:1), SAVESTR:(TFLAG:52))
		ENDIF
	ENDIF
ENDIF

;続いてC（チンコがありコンフィグonの場合のみ）
IF FLAG:518 > 0 && GET_PENIS(ARG:1) > 1
	;Cおねだり中は確率30％増加
	IF CFLAG:(ARG:1):50 == 55
		LOCAL:2 = TFLAG:65 + 30
	ELSE
		LOCAL:2 = TFLAG:65
	ENDIF
	;体調や素質の補正
	IF FLAG:7 >= 11
		LOCAL:2 += 20
	ELSEIF FLAG:7 >= 7
		LOCAL:2 += 10
	ENDIF
	SIF TALENT:(ARG:1):77
		LOCAL:2 += 5
	SIF TALENT:(ARG:1):132
		LOCAL:2 = LOCAL:5 / 2 + 1
	SIF TALENT:(ARG:1):136
		LOCAL:2 += 5
	;竿が太くて玉が大きければプラス、長くて包茎ならマイナス
	SIF TALENT:(ARG:1):170 > 0
		LOCAL:2 -= 5
	SIF TALENT:(ARG:1):171
		LOCAL:2 += 10
	SIF TALENT:(ARG:1):173
		LOCAL:2 -= 5
	SIF TALENT:(ARG:1):180
		LOCAL:2 += TALENT:(ARG:1):180 * 5
	IF RAND:100 < LOCAL:2
		CALL PARASITE_TYPE(ARG:1, 5, DA:(TFLAG:52):0, 4 + RAND:5 + RAND:5 + RAND:3, 0)
		CALL PRINT_MESSAGE(ARG:1, 40, TFLAG:52, CALLNAME:(ARG:1), SAVESTR:(TFLAG:52))
	ENDIF
ENDIF

;にんッしんッ！

;Vおねだり中は射精量+60
IF CFLAG:(ARG:1):50 == 57
	LOCAL:3 = TFLAG:65 + 60
;おねだり中は射精量+30
ELSEIF CFLAG:(ARG:1):50 >= 54 && CFLAG:(ARG:1):50 <= 58
	LOCAL:3 = TFLAG:65 + 30
ENDIF
CALL ESTRUS_CYCLE(ARG:1)
LOCAL:3 *= RESULT / 100
SIF CFLAG:(ARG:1):47 == 0
	CFLAG:(ARG:1):60 += LOCAL:3
;妊娠した場合確実に娘（寄生も上塗り）
IF RAND:(1 + CFLAG:(ARG:1):60) <= LOCAL:3 && CFLAG:(ARG:1):36 == 0 && CFLAG:(ARG:1):158 == 0
	CFLAG:(ARG:1):22 = 0
	CFLAG:(ARG:1):23 = 0
	CALL PARASITE_TYPE(ARG:1, 1, CFLAG:(ARG:1):57, 13 + RAND:2, RAND:1)
ENDIF

;おまけに確定で媚薬爆弾（口にぶち込まれる）
IF	FLAG:515 >= 1
	IF CFLAG:(ARG:1):158 == 0
		CFLAG:(ARG:1):158 = (8 + RAND:5)
	ENDIF
ENDIF

;汚れる
BASE:(ARG:1):5 += 10