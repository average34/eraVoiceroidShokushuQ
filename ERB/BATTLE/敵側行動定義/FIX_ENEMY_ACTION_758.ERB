@FIX_ENEMY_ACTION_758(ARG:0)

TFLAG:52 = ARG:0
TFLAG:54 = DA:(ARG:0):51
TFLAG:55 = 3
TFLAG:60 = 1

TFLAG:57 = DA:(ARG:0):5

TFLAG:58 = (4000 * ABL:(TFLAG:54):14) / (TFLAG:57 + 100)
;淫乱持ちは最大MPの割合でダメージ増加
SIF TALENT:(TFLAG:54):74 == 1
	TFLAG:58 = TFLAG:58 * (MAXBASE:(TFLAG:54):MP / (3000 + RAND:500))

TFLAG:61 = 120

TFLAG:64 = 50
TFLAG:65 = 0

TFLAG:59 = 0
TFLAG:90 = 50
TFLAG:91 = 0
IF CFLAG:(TFLAG:54):38 >= 5
	TFLAG:92 = 63
ELSE
	TFLAG:92 = 48
ENDIF
TFLAG:63 = 9

TFLAG:99 = 758

CALL ACTION_FILTER(-1, 4, 758, CALLNAME:(TFLAG:54), SAVESTR:(ARG:0), TFLAG:54, TFLAG:63)


@EXTRA_ACTION_758(ARG:0, ARG:1)

;汚れる
BASE:(TFLAG:54):5 += 10

;完全に飲み込まれて金玉まで到達していたら妊娠処理
IF CFLAG:(TFLAG:54):38 >= 5

	TFLAG:64 = 100
	;妊娠処理(ここでは射精量を溜めるのと、妊娠の対象を選ぶだけ)
	;Vおねだり中は射精量+30
	IF CFLAG:(ARG:1):50 == 57
		TFLAG:64 += 30
	;おねだり中は射精量+10
	ELSEIF CFLAG:(ARG:1):50 >= 54 && CFLAG:(ARG:1):50 <= 58
		TFLAG:64 += 10
	ENDIF

	CALL ESTRUS_CYCLE(ARG:1)
	TFLAG:64 *= RESULT / 100

	SIF CFLAG:(ARG:1):47 == 0
		CFLAG:(ARG:1):60 += TFLAG:64

	;妊娠した場合確実に娘（寄生も上塗り）
	IF RAND:(1 + CFLAG:(ARG:1):60) <= TFLAG:64 && CFLAG:(ARG:1):36 == 0 && CFLAG:(ARG:1):158 == 0
		CFLAG:(ARG:1):22 = 0
		CFLAG:(ARG:1):23 = 0
			CALL PARASITE_TYPE(ARG:1, 1, CFLAG:(ARG:1):57, 13 + RAND:2, RAND:1)
	ENDIF

;完全に呑み込まれていないなら精液中毒上昇
ELSE
	CALL ADD_ABL_EXP(14, TFLAG:54, SQRT(TFLAG:64))
ENDIF

