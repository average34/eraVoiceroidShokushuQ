@FIX_ENEMY_ACTION_720(ENEMY_ID)
#DIM ENEMY_ID
#DIM CHARA_ID

TFLAG:52 = ENEMY_ID
TFLAG:54 = DA:ENEMY_ID:51
CHARA_ID = DA:ENEMY_ID:51
TFLAG:55 = 3
TFLAG:60 = 1

TFLAG:57 = DA:ENEMY_ID:5

TFLAG:58 = 10000/ TFLAG:57 + 170
TFLAG:61 = 120

TFLAG:64 = 0
TFLAG:65 = 0

TFLAG:59 = 0
TFLAG:90 = 250
TFLAG:91 = 0
TFLAG:92 = 15

TFLAG:63 = 3
TFLAG:99 = 720

DA:ENEMY_ID:87 = RAND:2

;巨乳以上かつ拡張乳腺LV3以上でNF判定、判定成功でNFありメッセージになる
IF GET_BUST(CHARA_ID) >= 1 && TALENT:CHARA_ID:162 >= 3
	TRYCALL CALC_NIPPLE_FUCK(CHARA_ID, 3)
	SIF RESULT:0 == 1
		TFLAG:98 = 1
ELSE
	TFLAG:98 = 0
ENDIF

CALL ACTION_FILTER(-1, 4, 720, CALLNAME:(TFLAG:54), SAVESTR:ENEMY_ID, TFLAG:54, TFLAG:63)


@EXTRA_ACTION_720(ENEMY_ID, CHARA_ID)
#DIM ENEMY_ID
#DIM CHARA_ID
;LOCAL:0	NFダメージ計算

;NFメッセージを表示している
IF TFLAG:98 > 1
	;NF関連メッセージを表示した回数だけ乳姦経験＋、快感＋
	CFLAG:CHARA_ID:512 += TFLAG:98 - 1
	LOCAL:0 = CALC_NF_DAMAGE(CHARA_ID, 0)
	CALL EXTASY(CHARA_ID, 1, LOCAL:0 * (TFLAG:98 - 1) / 2, 250)
	;乳姦増加回数を初期値に戻す
	TFLAG:98 = 1
ENDIF

TFLAG:64 = 60
;妊娠処理(ここでは射精量を溜めるのと、妊娠の対象を選ぶだけ)
IF CFLAG:CHARA_ID:50 == 57
;Vおねだり中は射精量+60
	TFLAG:64 += 60
ELSEIF CFLAG:CHARA_ID:50 >= 54 && CFLAG:CHARA_ID:50 <= 58
;おねだり中は射精量+30
	TFLAG:64 += 30
ENDIF
CALL ESTRUS_CYCLE(CHARA_ID)
TFLAG:64 *= RESULT / 100
SIF CFLAG:CHARA_ID:47 == 0
	CFLAG:CHARA_ID:60 += TFLAG:64
IF RAND:(1 + CFLAG:CHARA_ID:60) <= TFLAG:64
	IF TFLAG:93
		CFLAG:CHARA_ID:57 = 5 + RAND:12
	ELSE
		CFLAG:CHARA_ID:57 = DA:(TFLAG:52):0
	ENDIF
ENDIF
SIF DA:(TFLAG:52):85 & 1
	CALL ADD_ABL_EXP(13, CHARA_ID, 2 + RAND:5)
SIF TFLAG:91 == 1 && TFLAG:59 == 0
	CALL SAMEN_DAMAGE(CHARA_ID, 250)
CALL ADD_ABL_EXP(14, CHARA_ID, SQRT(TFLAG:64))
;汚れる
BASE:CHARA_ID:5 += 10

