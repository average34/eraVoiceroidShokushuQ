@FIX_ENEMY_ACTION_766(ENEMY_ID)
#DIM ENEMY_ID

TFLAG:52 = ENEMY_ID
TFLAG:54 = DA:ENEMY_ID:51
TFLAG:55 = 3
TFLAG:60 = 1

TFLAG:57 = DA:ENEMY_ID:5

;豊乳化
IF RAND:3 && (FLAG:521 == 0 || FLAG:521 == 2 || (FLAG:521 == 3 && TALENT:(TFLAG:54):122 == 0))
	TFLAG:98 = 1
	TFLAG:58 = 10000 / TFLAG:57 + 200
;B感度増大
ELSE
	TFLAG:98 = 0
	TFLAG:58 = 10000 / TFLAG:57 + 170
ENDIF

TFLAG:61 = 150

TFLAG:64 = 15
TFLAG:65 = 50

TFLAG:59 = 0
TFLAG:90 = 500
TFLAG:92 = 2

TFLAG:63 = 1
TFLAG:99 = 766


CALL ACTION_FILTER(-1, 4, 766, CALLNAME:(TFLAG:54), SAVESTR:ENEMY_ID, TFLAG:54, TFLAG:63)


@EXTRA_ACTION_766(ENEMY_ID, CHARA_ID)
#DIM ENEMY_ID
#DIM CHARA_ID

;複乳パッチONならチェック
IF FLAG:598 > 0
	;淫乳かつBインプラントなら複乳化フラグ付与
	IF TALENT:CHARA_ID:76 && GETBIT(CFLAG:(CHARA_ID):81,2) == 1
		TRYCALL SUPERNUMERARY_BREASTS(CHARA_ID, 1)
		TRYCALL CHECK_SUPERNUMERARY_BREASTS(CHARA_ID)
	ENDIF
ENDIF

IF TFLAG:98 > 0
	;豊乳化
	IF FLAG:521 == 1
		;豊乳化OFF設定なら無効
	ELSEIF FLAG:521 == 3 && TALENT:CHARA_ID:122 > 0
		;男の娘のみOFF設定かつ男の娘なら無効
	ELSE
		;絶壁
		IF GET_BUST(CHARA_ID) <= -2
			CALL PRINT_MESSAGE(CHARA_ID, 427, 5, CALLNAME:CHARA_ID, "")
		;貧乳
		ELSEIF GET_BUST(CHARA_ID) == -1
			CALL PRINT_MESSAGE(CHARA_ID, 427, 0, CALLNAME:CHARA_ID, "")
		;普通
		ELSEIF GET_BUST(CHARA_ID) == 0
			CALL PRINT_MESSAGE(CHARA_ID, 427, 1, CALLNAME:CHARA_ID, "")
		;巨乳
		ELSEIF GET_BUST(CHARA_ID) == 1
			CALL PRINT_MESSAGE(CHARA_ID, 427, 2, CALLNAME:CHARA_ID, "")
		;爆乳
		ELSEIF GET_BUST(CHARA_ID) == 2
			CALL PRINT_MESSAGE(CHARA_ID, 427, 3, CALLNAME:CHARA_ID, "")
		;超乳
		ELSEIF GET_BUST(CHARA_ID) >= 3
			CALL PRINT_MESSAGE(CHARA_ID, 427, 6, CALLNAME:CHARA_ID, "")
		ENDIF
		CALL ADD_BUST(CHARA_ID,1,2)
		IF GET_BUST(CHARA_ID) >= 2
			CALL MILK_COME(CHARA_ID, 1, 2)
			CALL MILK_ADJUST(CHARA_ID, 0)
		ENDIF
	ENDIF
ELSE
	;B感度増大
	SIF	TALENT:CHARA_ID:102 < 3
		TALENT:CHARA_ID:102 += 1
ENDIF
